(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return Dp});var r=n("ofXK"),i=n("fXoL"),o=n("tyNb"),s=n("/t3+"),a=n("bTqV"),u=n("NFeN"),c=n("XhcP"),h=n("MutI"),l=n("FKr1");let f=(()=>{class t{constructor(t){this.router=t,this.loading=!0,this.menu=[{name:"Dashboard",icon:"dashboard",url:"/admin/dashboard"},{group:"Menu Group",children:[{name:"Image Gallery",icon:"images",url:"/admin/images"}]}]}ngOnInit(){}Logout(){confirm("Keluar aplikasi?")&&(localStorage.removeItem("appToken"),this.router.navigate(["/login"]))}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(o.a))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-admin"]],decls:30,vars:9,consts:[["color","primary",1,"example-header"],["mat-icon-button","",3,"click"],[1,"uk-width-expand"],["mat-button","",3,"click"],[1,"admin-container"],["mode","side",1,"sidenav-left",3,"position","opened","fixedInViewport","fixedTopGap","fixedBottomGap"],["sidenav",""],["routerLink","/admin/dashboard"],["matListIcon",""],["matLine",""],["routerLink","/admin/product"],["mode","side",1,"example-sidenav",3,"position","fixedInViewport","fixedTopGap","fixedBottomGap"],[2,"padding","20px","background-color","#ccc"]],template:function(t,e){if(1&t){const t=i.Vb();i.Sb(0),i.Ub(1,"mat-toolbar",0),i.Ub(2,"button",1),i.bc("click",function(){return i.rc(t),i.pc(14).toggle()}),i.Ub(3,"mat-icon"),i.yc(4,"menu"),i.Tb(),i.Tb(),i.Ub(5,"span"),i.yc(6,"My Angular"),i.Tb(),i.Pb(7,"div",2),i.Ub(8,"small"),i.yc(9,"Admin"),i.Tb(),i.Ub(10,"button",3),i.bc("click",function(){return e.Logout()}),i.yc(11,"Logout"),i.Tb(),i.Tb(),i.Ub(12,"mat-sidenav-container",4),i.Ub(13,"mat-sidenav",5,6),i.Ub(15,"mat-nav-list"),i.Ub(16,"mat-list-item",7),i.Ub(17,"mat-icon",8),i.yc(18,"dashboard"),i.Tb(),i.Ub(19,"h3",9),i.yc(20,"Dasboard"),i.Tb(),i.Tb(),i.Ub(21,"mat-list-item",10),i.Ub(22,"mat-icon",8),i.yc(23,"camera_enhance"),i.Tb(),i.Ub(24,"h3",9),i.yc(25,"Products"),i.Tb(),i.Tb(),i.Tb(),i.Tb(),i.Pb(26,"mat-sidenav",11,6),i.Ub(28,"mat-sidenav-content",12),i.Pb(29,"router-outlet"),i.Tb(),i.Tb(),i.Rb()}2&t&&(i.Db(13),i.kc("position","start")("opened",!0)("fixedInViewport",!0)("fixedTopGap",65)("fixedBottomGap",0),i.Db(13),i.kc("position","end")("fixedInViewport",!0)("fixedTopGap",60)("fixedBottomGap",0))},directives:[s.a,a.a,u.a,c.b,c.a,h.d,h.b,o.b,h.a,l.j,c.c,o.d],styles:[""]}),t})(),d=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Ib({type:t,selectors:[["app-dashboard"]],decls:54,vars:0,consts:[["lang","en"],["charset","utf-8"],["http-equiv","X-UA-Compatible","content","IE=edge"],["name","viewport","content","width=device-width, initial-scale=1"],["name","Description","lang","en","content",""],[1,"row","row--banner"],[1,"row","container-medium","banner-content"],[1,"banner-content__heading"],[1,"row","row--white","row--padding-wide","features"],[1,"row","container-medium"],[1,"row","features__row"],[1,"col-narrow--right","features__bike"],[1,"col-wide"],[1,"features__heading"],["src","https://post.healthline.com/wp-content/uploads/2020/09/no-carb-diet-732x549-thumbnail.jpg",1,"img","img-responsive"],[1,"col-narrow","features__phone"],[1,"col-wide--right","features__padding"],["src","https://images.indianexpress.com/2018/12/Food-trends-Getty-Images-759.jpg",1,"img","img-responsive"],[1,"col-narrow--right","features__safe"],["src","https://a-lifestyle.com/wp-content/uploads/2020/09/smoothie-scaled-780x470.jpg",1,"img","img-responsive"],[1,"features"],[1,"button2","center"],[1,"row","row--dark-grey","row--padding-narrow"],[1,"row","container-wide"]],template:function(t,e){1&t&&(i.Ub(0,"html",0),i.Ub(1,"head"),i.Pb(2,"meta",1),i.Pb(3,"meta",2),i.Ub(4,"title"),i.yc(5,"Toko Online"),i.Tb(),i.Pb(6,"meta",3),i.Pb(7,"meta",4),i.Tb(),i.Ub(8,"body"),i.Ub(9,"div",5),i.Ub(10,"section",6),i.Ub(11,"h1",7),i.yc(12," RESEP MAKANAN DIET "),i.Tb(),i.Tb(),i.Tb(),i.Ub(13,"div",8),i.Ub(14,"div",9),i.Ub(15,"div",10),i.Pb(16,"div",11),i.Ub(17,"div",12),i.Ub(18,"h2",13),i.yc(19," BREAKFAST "),i.Tb(),i.Pb(20,"img",14),i.Pb(21,"br"),i.Ub(22,"p"),i.yc(23,"Dengan harga terjangkau dengan kualitas bagus garansi 1 tahun. jangan lewatkan kesempatan anda untuk memiliki komputer ini untuk belajar anda."),i.Tb(),i.Pb(24,"br"),i.Tb(),i.Tb(),i.Ub(25,"div",10),i.Pb(26,"div",15),i.Ub(27,"div",16),i.Ub(28,"h2",13),i.yc(29," LUNCH "),i.Tb(),i.Pb(30,"img",17),i.Pb(31,"br"),i.Ub(32,"p"),i.yc(33," Dengan harga terjangkau dengan kualitas bagus garansi 1 tahun. jangan lewatkan kesempatan anda untuk memiliki komputer ini untuk belajar anda. "),i.Tb(),i.Pb(34,"br"),i.Tb(),i.Tb(),i.Ub(35,"div",10),i.Pb(36,"div",18),i.Ub(37,"div",12),i.Ub(38,"h2",13),i.yc(39," DINNER "),i.Tb(),i.Pb(40,"img",19),i.Pb(41,"br"),i.Ub(42,"p",20),i.yc(43,"Dengan harga terjangkau dengan kualitas bagus garansi 1 tahun. jangan lewatkan kesempatan anda untuk memiliki komputer ini untuk belajar anda."),i.Tb(),i.Pb(44,"br"),i.Ub(45,"button",21),i.Ub(46,"span"),i.yc(47,"Beli!"),i.Tb(),i.Tb(),i.Pb(48,"br"),i.Pb(49,"br"),i.Tb(),i.Tb(),i.Tb(),i.Tb(),i.Ub(50,"div",22),i.Ub(51,"footer",23),i.Pb(52,"div",12),i.Tb(),i.Tb(),i.Tb(),i.Tb(),i.Pb(53,"router-outlet"))},directives:[o.d],styles:[""]}),t})();var p=n("FEZI");let y=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Ib({type:t,selectors:[["app-images"]],decls:2,vars:0,template:function(t,e){1&t&&(i.Ub(0,"p"),i.yc(1,"images works!"),i.Tb())},styles:[""]}),t})();var g=n("0IaG"),v=n("D0XW"),m=n("HDdC"),b=n("Cfvw"),w=n("LRne"),T=n("JX91"),I=n("Zy1z"),E=n("lJxs"),_=n("Kqap"),O=n("/uUt"),S=n("pLZG"),D=n("pxpQ"),N=n("spgP"),A=n("Jgta"),k=n("zIRd"),j=n("mrSG"),x=n("qOnz"),C=n("q/0M"),R=function(t,e){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function P(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var L,M="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},F=F||{},U=M||self;function V(){}function q(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function B(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var K="closure_uid_"+(1e9*Math.random()>>>0),G=0;function z(t,e,n){return t.call.apply(t.bind,arguments)}function Q(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function H(t,e,n){return(H=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?z:Q).apply(null,arguments)}function W(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Y(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function X(){this.s=this.s,this.o=this.o}var $={};X.prototype.s=!1,X.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,K)&&t[K]||(t[K]=++G)}(this);delete $[t]}},X.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var J=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function tt(t){return Array.prototype.concat.apply([],arguments)}function et(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function nt(t){return/^[\s\xa0]*$/.test(t)}var rt,it=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function ot(t,e){return-1!=t.indexOf(e)}function st(t,e){return t<e?-1:t>e?1:0}t:{var at=U.navigator;if(at){var ut=at.userAgent;if(ut){rt=ut;break t}}rt=""}function ct(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function ht(t){var e={};for(var n in t)e[n]=t[n];return e}var lt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ft(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<lt.length;o++)n=lt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function dt(t){return dt[" "](t),t}dt[" "]=V;var pt,yt,gt=ot(rt,"Opera"),vt=ot(rt,"Trident")||ot(rt,"MSIE"),mt=ot(rt,"Edge"),bt=mt||vt,wt=ot(rt,"Gecko")&&!(ot(rt.toLowerCase(),"webkit")&&!ot(rt,"Edge"))&&!(ot(rt,"Trident")||ot(rt,"MSIE"))&&!ot(rt,"Edge"),Tt=ot(rt.toLowerCase(),"webkit")&&!ot(rt,"Edge");function It(){var t=U.document;return t?t.documentMode:void 0}t:{var Et="",_t=(yt=rt,wt?/rv:([^\);]+)(\)|;)/.exec(yt):mt?/Edge\/([\d\.]+)/.exec(yt):vt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(yt):Tt?/WebKit\/(\S+)/.exec(yt):gt?/(?:Version)[ \/]?(\S+)/.exec(yt):void 0);if(_t&&(Et=_t?_t[1]:""),vt){var Ot=It();if(null!=Ot&&Ot>parseFloat(Et)){pt=String(Ot);break t}}pt=Et}var St={};var Dt=U.document&&vt&&(It()||parseInt(pt,10))||void 0,Nt=function(){if(!U.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{U.addEventListener("test",V,e),U.removeEventListener("test",V,e)}catch(n){}return t}();function At(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function kt(t,e){if(At.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(wt){t:{try{dt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:jt[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&kt.Z.h.call(this)}}At.prototype.h=function(){this.defaultPrevented=!0},Y(kt,At);var jt={2:"touch",3:"pen",4:"mouse"};kt.prototype.h=function(){kt.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var xt="closure_listenable_"+(1e6*Math.random()|0),Ct=0;function Rt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++Ct,this.ca=this.fa=!1}function Pt(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Lt(t){this.src=t,this.g={},this.h=0}function Mt(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=J(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Pt(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Ft(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Lt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=Ft(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new Rt(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var Ut="closure_lm_"+(1e6*Math.random()|0),Vt={};function qt(t,e,n,r,i){if(r&&r.once)return Kt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)qt(t,e[o],n,r,i);return null}return n=Xt(n),t&&t[xt]?t.N(e,n,B(r)?!!r.capture:!!r,i):Bt(t,e,n,!1,r,i)}function Bt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=B(i)?!!i.capture:!!i,a=Wt(t);if(a||(t[Ut]=a=new Lt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Ht;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Nt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Qt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Kt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Kt(t,e[o],n,r,i);return null}return n=Xt(n),t&&t[xt]?t.O(e,n,B(r)?!!r.capture:!!r,i):Bt(t,e,n,!0,r,i)}function Gt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Gt(t,e[o],n,r,i);else r=B(r)?!!r.capture:!!r,n=Xt(n),t&&t[xt]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Ft(o=t.g[e],n,r,i))&&(Pt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--))):t&&(t=Wt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ft(e,n,r,i)),(n=-1<t?e[t]:null)&&zt(n))}function zt(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[xt])Mt(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Qt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Wt(e))?(Mt(n,t),0==n.h&&(n.src=null,e[Ut]=null)):Pt(t)}}}function Qt(t){return t in Vt?Vt[t]:Vt[t]="on"+t}function Ht(t,e){if(t.ca)t=!0;else{e=new kt(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&zt(t),t=n.call(r,e)}return t}function Wt(t){return(t=t[Ut])instanceof Lt?t:null}var Yt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xt(t){return"function"==typeof t?t:(t[Yt]||(t[Yt]=function(e){return t.handleEvent(e)}),t[Yt])}function $t(){X.call(this),this.i=new Lt(this),this.P=this,this.I=null}function Jt(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new At(e,t);else if(e instanceof At)e.target=e.target||t;else{var i=e;ft(e=new At(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=Zt(s,r,!0,e)&&i}if(i=Zt(s=e.g=t,r,!0,e)&&i,i=Zt(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Zt(s=e.g=n[o],r,!1,e)&&i}function Zt(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&Mt(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Y($t,X),$t.prototype[xt]=!0,$t.prototype.removeEventListener=function(t,e,n,r){Gt(this,t,e,n,r)},$t.prototype.M=function(){if($t.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Pt(n[r]);delete e.g[t],e.h--}}this.I=null},$t.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},$t.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var te=U.JSON.stringify;function ee(){var t=ce,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var ne,re=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=ie.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),ie=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,this.g=(t=this.g).next,t.next=null):t=this.i(),t},t}())(function(){return new oe},function(t){return t.reset()}),oe=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function se(t){U.setTimeout(function(){throw t},0)}function ae(t,e){ne||function(){var t=U.Promise.resolve(void 0);ne=function(){t.then(he)}}(),ue||(ne(),ue=!0),ce.add(t,e)}var ue=!1,ce=new re;function he(){for(var t;t=ee();){try{t.h.call(t.g)}catch(n){se(n)}var e=ie;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}ue=!1}function le(t,e){$t.call(this),this.h=t||1,this.g=e||U,this.j=H(this.kb,this),this.l=Date.now()}function fe(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function de(t,e,n){if("function"==typeof t)n&&(t=H(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=H(t.handleEvent,t)}return 2147483647<Number(e)?-1:U.setTimeout(t,e||0)}function pe(t){t.g=de(function(){t.g=null,t.i&&(t.i=!1,pe(t))},t.j);var e=t.h;t.h=null,t.m.apply(null,e)}Y(le,$t),(L=le.prototype).da=!1,L.S=null,L.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Jt(this,"tick"),this.da&&(fe(this),this.start()))}},L.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},L.M=function(){le.Z.M.call(this),fe(this),delete this.g};var ye=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}R(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:pe(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(U.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(X);function ge(t){X.call(this),this.h=t,this.g={}}Y(ge,X);var ve=[];function me(t,e,n,r){Array.isArray(n)||(n&&(ve[0]=n.toString()),n=ve);for(var i=0;i<n.length;i++){var o=qt(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function be(t){ct(t.g,function(t,e){this.g.hasOwnProperty(e)&&zt(t)},t),t.g={}}function we(){this.g=!0}function Te(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return te(n)}catch(a){return e}}(t,n)+(r?" "+r:"")})}ge.prototype.M=function(){ge.Z.M.call(this),be(this)},ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},we.prototype.Aa=function(){this.g=!1},we.prototype.info=function(){};var Ie={},Ee=null;function _e(){return Ee=Ee||new $t}function Oe(t){At.call(this,Ie.Ma,t)}function Se(t){var e=_e();Jt(e,new Oe(e,t))}function De(t,e){At.call(this,Ie.STAT_EVENT,t),this.stat=e}function Ne(t){var e=_e();Jt(e,new De(e,t))}function Ae(t,e){At.call(this,Ie.Na,t),this.size=e}function ke(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return U.setTimeout(function(){t()},e)}Ie.Ma="serverreachability",Y(Oe,At),Ie.STAT_EVENT="statevent",Y(De,At),Ie.Na="timingevent",Y(Ae,At);var je={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},xe={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Ce(){}function Re(){}Ce.prototype.h=null;var Pe,Le={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Me(){At.call(this,"d")}function Fe(){At.call(this,"c")}function Ue(){}function Ve(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new ge(this),this.P=Be,this.W=new le(t=bt?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new qe}function qe(){this.i=null,this.g="",this.h=!1}Y(Me,At),Y(Fe,At),Y(Ue,Ce),Ue.prototype.g=function(){return new XMLHttpRequest},Ue.prototype.i=function(){return{}},Pe=new Ue;var Be=45e3,Ke={},Ge={};function ze(t,e,n){t.K=1,t.v=yn(cn(e)),t.s=n,t.U=!0,Qe(t,null)}function Qe(t,e){t.F=Date.now(),Xe(t),t.A=cn(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Nn(n.h,"t",r),t.C=0,n=t.l.H,t.h=new qe,t.g=Ar(t.l,n?e:null,!t.s),0<t.O&&(t.L=new ye(H(t.Ia,t,t.g),t.O)),me(t.V,t.g,"readystatechange",t.gb),e=t.H?ht(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Se(1),function(t,e,n,r,i,o){t.info(function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.j,t.u,t.A,t.m,t.X,t.s)}function He(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function We(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Ye(t,n))==Ge){4==e&&(t.o=4,Ne(14),i=!1),Te(t.j,t.m,null,"[Incomplete Response]");break}if(r==Ke){t.o=4,Ne(15),Te(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Te(t.j,t.m,r,null),en(t,r)}He(t)&&r!=Ge&&r!=Ke&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Ne(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Tr(e),e.L=!0,Ne(11))):(Te(t.j,t.m,n,"[Invalid Chunked Response]"),tn(t),Ze(t))}function Ye(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Ge:(n=Number(e.substring(n,r)),isNaN(n)?Ke:(r+=1)+n>e.length?Ge:(e=e.substr(r,n),t.C=r+n,e))}function Xe(t){t.Y=Date.now()+t.P,$e(t,t.P)}function $e(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ke(H(t.eb,t),e)}function Je(t){t.B&&(U.clearTimeout(t.B),t.B=null)}function Ze(t){0==t.l.G||t.I||_r(t.l,t)}function tn(t){Je(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,fe(t.W),be(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function en(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Pn(n.i,t)))if(n.I=t.N,!t.J&&Pn(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Er(n),fr(n)}wr(n),Ne(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=ke(H(n.ab,n),6e3));if(1>=Rn(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else Sr(n,11)}else if((t.J||n.g==t)&&Er(n),!nt(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(ot(h,"spdy")||ot(h,"quic")||ot(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(Ln(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,pn(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=t;if((r=n).oa=Nr(r,r.H?r.la:null,r.W),d.J){Mn(r.i,d);var p=d,y=r.K;y&&p.setTimeout(y),p.B&&(Je(p),Xe(p)),r.g=d}else br(r);0<n.l.length&&yr(n)}else"stop"!=o[0]&&"close"!=o[0]||Sr(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?Sr(n,7):lr(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}Se(4)}catch(o){}}function nn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(q(t)||"string"==typeof t)Z(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(q(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(q(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function rn(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof rn)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function on(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];sn(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)sn(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function sn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(L=Ve.prototype).setTimeout=function(t){this.P=t},L.gb=function(t){t=t.target;var e=this.L;e&&3==sr(t)?e.l():this.Ia(t)},L.Ia=function(t){try{if(t==this.g)t:{var e=sr(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||bt||this.g&&(this.h.h||this.g.ga()||ar(this.g)))){this.I||4!=e||7==n||Se(8==n||0>=r?3:2),Je(this);var i=this.g.ba();this.N=i;e:if(He(this)){var o=ar(this.g);t="";var s=o.length,a=4==sr(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){tn(this),Ze(this);var u="";break e}this.h.i=new U.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!nt(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,Ne(12),tn(this),Ze(this);break t}Te(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,en(this,i)}this.U?(We(this,e,u),bt&&this.i&&3==e&&(me(this.V,this.W,"tick",this.fb),this.W.start())):(Te(this.j,this.m,u,null),en(this,u)),4==e&&tn(this),this.i&&!this.I&&(4==e?_r(this.l,this):(this.i=!1,Xe(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Ne(12)):(this.o=0,Ne(13)),tn(this),Ze(this)}}}catch(e){}},L.fb=function(){if(this.g){var t=sr(this.g),e=this.g.ga();this.C<e.length&&(Je(this),We(this,t,e),this.i&&4!=t&&Xe(this))}},L.cancel=function(){this.I=!0,tn(this)},L.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Se(3),Ne(17)),tn(this),this.o=2,Ze(this)):$e(this,this.Y-t)},(L=rn.prototype).R=function(){on(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},L.T=function(){return on(this),this.g.concat()},L.get=function(t,e){return sn(this.h,t)?this.h[t]:e},L.set=function(t,e){sn(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},L.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var an=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function un(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof un){this.g=void 0!==e?e:t.g,hn(this,t.j),this.s=t.s,ln(this,t.i),fn(this,t.m),this.l=t.l,e=t.h;var n=new _n;n.i=e.i,e.g&&(n.g=new rn(e.g),n.h=e.h),dn(this,n),this.o=t.o}else t&&(n=String(t).match(an))?(this.g=!!e,hn(this,n[1]||"",!0),this.s=gn(n[2]||""),ln(this,n[3]||"",!0),fn(this,n[4]),this.l=gn(n[5]||"",!0),dn(this,n[6]||"",!0),this.o=gn(n[7]||"")):(this.g=!!e,this.h=new _n(null,this.g))}function cn(t){return new un(t)}function hn(t,e,n){t.j=n?gn(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ln(t,e,n){t.i=n?gn(e,!0):e}function fn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function dn(t,e,n){e instanceof _n?(t.h=e,function(t,e){e&&!t.j&&(On(t),t.i=null,t.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Sn(this,e),Nn(this,n,t))},t)),t.j=e}(t.h,t.g)):(n||(e=vn(e,In)),t.h=new _n(e,t.g))}function pn(t,e,n){t.h.set(e,n)}function yn(t){return pn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function gn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function vn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,mn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function mn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}un.prototype.toString=function(){var t=[],e=this.j;e&&t.push(vn(e,bn,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(vn(e,bn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(vn(n,"/"==n.charAt(0)?Tn:wn,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",vn(n,En)),t.join("")};var bn=/[#\/\?@]/g,wn=/[#\?:]/g,Tn=/[#\?]/g,In=/[#\?@]/g,En=/#/g;function _n(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function On(t){t.g||(t.g=new rn,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Sn(t,e){On(t),e=An(t,e),sn(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,sn((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&on(t)))}function Dn(t,e){return On(t),e=An(t,e),sn(t.g.h,e)}function Nn(t,e,n){Sn(t,e),0<n.length&&(t.i=null,t.g.set(An(t,e),et(n)),t.h+=n.length)}function An(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(L=_n.prototype).add=function(t,e){On(this),this.i=null,t=An(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},L.forEach=function(t,e){On(this),this.g.forEach(function(n,r){Z(n,function(n){t.call(e,n,r,this)},this)},this)},L.T=function(){On(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},L.R=function(t){On(this);var e=[];if("string"==typeof t)Dn(this,t)&&(e=tt(e,this.g.get(An(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=tt(e,t[n])}return e},L.set=function(t,e){return On(this),this.i=null,Dn(this,t=An(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},L.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},L.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var kn=function(){return function(t,e){this.h=t,this.g=e}}();function jn(t){this.l=t||xn,t=U.PerformanceNavigationTiming?0<(t=U.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(U.g&&U.g.Ea&&U.g.Ea()&&U.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var xn=10;function Cn(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Rn(t){return t.h?1:t.g?t.g.size:0}function Pn(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Ln(t,e){t.g?t.g.add(e):t.h=e}function Mn(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Fn(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=P(t.g.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.D)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return et(t.i)}function Un(){}function Vn(){this.g=new Un}function qn(t,e,n){var r=n||"";try{nn(t,function(t,n){var i=t;B(t)&&(i=te(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(Xd){throw e.push(r+"type="+encodeURIComponent("_badmap")),Xd}}function Bn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}function Kn(t){this.l=t.$b||null,this.j=t.ib||!1}function Gn(t,e){$t.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=zn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}jn.prototype.cancel=function(){var t,e;if(this.i=Fn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=P(this.g.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},Un.prototype.stringify=function(t){return U.JSON.stringify(t,void 0)},Un.prototype.parse=function(t){return U.JSON.parse(t,void 0)},Y(Kn,Ce),Kn.prototype.g=function(){return new Gn(this.l,this.j)},Kn.prototype.i=function(t){return function(){return t}}({}),Y(Gn,$t);var zn=0;function Qn(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Hn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Wn(t)}function Wn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(L=Gn.prototype).open=function(t,e){if(this.readyState!=zn)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Wn(this)},L.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||U).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},L.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Hn(this)),this.readyState=zn},L.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Wn(this)),this.g&&(this.readyState=3,Wn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==U.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Qn(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},L.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Hn(this):Wn(this),3==this.readyState&&Qn(this)}},L.Ua=function(t){this.g&&(this.response=this.responseText=t,Hn(this))},L.Ta=function(t){this.g&&(this.response=t,Hn(this))},L.ha=function(){this.g&&Hn(this)},L.setRequestHeader=function(t,e){this.v.append(t,e)},L.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},L.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Gn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Yn=U.JSON.parse;function Xn(t){$t.call(this),this.headers=new rn,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=$n,this.K=this.L=!1}Y(Xn,$t);var $n="",Jn=/^https?$/i,Zn=["POST","PUT"];function tr(t){return"content-type"==t.toLowerCase()}function er(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,nr(t),ir(t)}function nr(t){t.D||(t.D=!0,Jt(t,"complete"),Jt(t,"error"))}function rr(t){if(t.h&&void 0!==F&&(!t.C[1]||4!=sr(t)||2!=t.ba()))if(t.v&&4==sr(t))de(t.Fa,0,t);else if(Jt(t,"readystatechange"),4==sr(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(an)[1]||null;if(!o&&U.self&&U.self.location){var s=U.self.location.protocol;o=s.substr(0,s.length-1)}i=!Jn.test(o?o.toLowerCase():"")}e=i}if(e)Jt(t,"complete"),Jt(t,"success");else{t.m=6;try{var a=2<sr(t)?t.g.statusText:""}catch(u){a=""}t.j=a+" ["+t.ba()+"]",nr(t)}}finally{ir(t)}}}function ir(t,e){if(t.g){or(t);var n=t.g,r=t.C[0]?V:null;t.g=null,t.C=null,e||Jt(t,"ready");try{n.onreadystatechange=r}catch(Xd){}}}function or(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(U.clearTimeout(t.A),t.A=null)}function sr(t){return t.g?t.g.readyState:0}function ar(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case $n:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function ur(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return ct(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):pn(t,e,n))}function cr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function hr(t){this.za=0,this.l=[],this.h=new we,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=cr("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=cr("baseRetryDelayMs",5e3,t),this.$a=cr("retryDelaySeedMs",1e4,t),this.Ya=cr("forwardChannelMaxRetries",2,t),this.ra=cr("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new jn(t&&t.concurrentRequestLimit),this.Ca=new Vn,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function lr(t){if(dr(t),3==t.G){var e=t.V++,n=cn(t.F);pn(n,"SID",t.J),pn(n,"RID",e),pn(n,"TYPE","terminate"),vr(t,n),(e=new Ve(t,t.h,e,void 0)).K=2,e.v=yn(cn(n)),n=!1,U.navigator&&U.navigator.sendBeacon&&(n=U.navigator.sendBeacon(e.v.toString(),"")),!n&&U.Image&&((new Image).src=e.v,n=!0),n||(e.g=Ar(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Xe(e)}Dr(t)}function fr(t){t.g&&(Tr(t),t.g.cancel(),t.g=null)}function dr(t){fr(t),t.u&&(U.clearTimeout(t.u),t.u=null),Er(t),t.i.cancel(),t.m&&("number"==typeof t.m&&U.clearTimeout(t.m),t.m=null)}function pr(t,e){t.l.push(new kn(t.Za++,e)),3==t.G&&yr(t)}function yr(t){Cn(t.i)||t.m||(t.m=!0,ae(t.Ha,t),t.C=0)}function gr(t,e){var n;n=e?e.m:t.V++;var r=cn(t.F);pn(r,"SID",t.J),pn(r,"RID",n),pn(r,"AID",t.U),vr(t,r),t.o&&t.s&&ur(r,t.o,t.s),n=new Ve(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=mr(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Ln(t.i,n),ze(n,r,e)}function vr(t,e){t.j&&nn({},function(t,n){pn(e,n,t)})}function mr(t,e,n){n=Math.min(t.l.length,n);var r=t.j?H(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].h)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{qn(h,s,"req"+c+"_")}catch(ci){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function br(t){t.g||t.u||(t.Y=1,ae(t.Ga,t),t.A=0)}function wr(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=ke(H(t.Ga,t),Or(t,t.A)),t.A++,0))}function Tr(t){null!=t.B&&(U.clearTimeout(t.B),t.B=null)}function Ir(t){t.g=new Ve(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=cn(t.oa);pn(e,"RID","rpc"),pn(e,"SID",t.J),pn(e,"CI",t.N?"0":"1"),pn(e,"AID",t.U),vr(t,e),pn(e,"TYPE","xmlhttp"),t.o&&t.s&&ur(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=yn(cn(e)),n.s=null,n.U=!0,Qe(n,t)}function Er(t){null!=t.v&&(U.clearTimeout(t.v),t.v=null)}function _r(t,e){var n=null;if(t.g==e){Er(t),Tr(t),t.g=null;var r=2}else{if(!Pn(t.i,e))return;n=e.D,Mn(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Jt(r=_e(),new Ae(r,n,e,i)),yr(t)}else br(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Rn(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=ke(H(t.Ha,t,e),Or(t,t.C)),t.C++,0)))}(t,e)||2==r&&wr(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Sr(t,5);break;case 4:Sr(t,10);break;case 3:Sr(t,6);break;default:Sr(t,2)}}function Or(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Sr(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=H(t.jb,t);n||(n=new un("//www.google.com/images/cleardot.gif"),U.location&&"http"==U.location.protocol||hn(n,"https"),yn(n)),function(t,e){var n=new we;if(U.Image){var r=new Image;r.onload=W(Bn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=W(Bn,n,r,"TestLoadImage: error",!1,e),r.onabort=W(Bn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=W(Bn,n,r,"TestLoadImage: timeout",!1,e),U.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ne(2);t.G=0,t.j&&t.j.va(e),Dr(t),dr(t)}function Dr(t){t.G=0,t.I=-1,t.j&&(0==Fn(t.i).length&&0==t.l.length||(t.i.i.length=0,et(t.l),t.l.length=0),t.j.ua())}function Nr(t,e,n){var r=function(t){return t instanceof un?cn(t):new un(t,void 0)}(n);if(""!=r.i)e&&ln(r,e+"."+r.i),fn(r,r.m);else{var i=U.location;r=function(t,e,n,r){var i=new un(null,void 0);return t&&hn(i,t),e&&ln(i,e),n&&fn(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&ct(t.aa,function(t,e){pn(r,e,t)}),n=t.sa,(e=t.D)&&n&&pn(r,e,n),pn(r,"VER",t.ma),vr(t,r),r}function Ar(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Xn(n&&t.Ba&&!t.qa?new Kn({ib:!0}):t.qa)).L=t.H,e}function kr(){}function jr(){if(vt&&!(10<=Number(Dt)))throw Error("Environmental error: no available transport.")}function xr(t,e){$t.call(this),this.g=new hr(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!nt(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!nt(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Pr(this)}function Cr(t){Me.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Rr(){Fe.call(this),this.status=1}function Pr(t){this.g=t}(L=Xn.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Pe.g(),this.C=function(t){return t.h||(t.h=t.i())}(this.u?this.u:Pe),this.g.onreadystatechange=H(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(o){return void er(this,o)}t=n||"";var i=new rn(this.headers);r&&nn(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=tr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=U.FormData&&t instanceof U.FormData,!(0<=J(Zn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.g.setRequestHeader(e,t)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{or(this),0<this.B&&((this.K=function(t){return vt&&function(){return t=St,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){for(var t=0,e=it(String(pt)).split("."),n=it("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=st(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||st(0==o[2].length,0==s[2].length)||st(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}();var t}()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=H(this.pa,this)):this.A=de(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){er(this,o)}},L.pa=function(){void 0!==F&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Jt(this,"timeout"),this.abort(8))},L.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Jt(this,"complete"),Jt(this,"abort"),ir(this))},L.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ir(this,!0)),Xn.Z.M.call(this)},L.Fa=function(){this.s||(this.F||this.v||this.l?rr(this):this.cb())},L.cb=function(){rr(this)},L.ba=function(){try{return 2<sr(this)?this.g.status:-1}catch(yt){return-1}},L.ga=function(){try{return this.g?this.g.responseText:""}catch(yt){return""}},L.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Yn(e)}},L.Da=function(){return this.m},L.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(L=hr.prototype).ma=8,L.G=1,L.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},L.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new Ve(this,this.h,t,void 0),n=this.s;if(this.P&&(n?ft(n=ht(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=mr(this,e,r),pn(i=cn(this.F),"RID",t),pn(i,"CVER",22),this.D&&pn(i,"X-HTTP-Session-Id",this.D),vr(this,i),this.o&&n&&ur(i,this.o,n),Ln(this.i,e),this.Ra&&pn(i,"TYPE","init"),this.ja?(pn(i,"$req",r),pn(i,"SID","null"),e.$=!0,ze(e,i,null)):ze(e,i,r),this.G=2}}else 3==this.G&&(t?gr(this,t):0==this.l.length||Cn(this.i)||gr(this))},L.Ga=function(){if(this.u=null,Ir(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=ke(H(this.bb,this),t)}},L.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ne(10),fr(this),Ir(this))},L.ab=function(){null!=this.v&&(this.v=null,fr(this),wr(this),Ne(19))},L.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Ne(2)):(this.h.info("Failed to ping google.com"),Ne(1))},(L=kr.prototype).xa=function(){},L.wa=function(){},L.va=function(){},L.ua=function(){},L.Oa=function(){},jr.prototype.g=function(t,e){return new xr(t,e)},Y(xr,$t),xr.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),ae(H(t.hb,t,e))),Ne(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=Nr(t,null,t.W),yr(t)},xr.prototype.close=function(){lr(this.g)},xr.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,pr(this.g,e)}else this.v?((e={}).__data__=te(t),pr(this.g,e)):pr(this.g,t)},xr.prototype.M=function(){this.g.j=null,delete this.j,lr(this.g),delete this.g,xr.Z.M.call(this)},Y(Cr,Me),Y(Rr,Fe),Y(Pr,kr),Pr.prototype.xa=function(){Jt(this.g,"a")},Pr.prototype.wa=function(t){Jt(this.g,new Cr(t))},Pr.prototype.va=function(t){Jt(this.g,new Rr(t))},Pr.prototype.ua=function(){Jt(this.g,"b")},jr.prototype.createWebChannel=jr.prototype.g,xr.prototype.send=xr.prototype.u,xr.prototype.open=xr.prototype.m,xr.prototype.close=xr.prototype.close,je.NO_ERROR=0,je.TIMEOUT=8,je.HTTP_ERROR=6,xe.COMPLETE="complete",Re.EventType=Le,Le.OPEN="a",Le.CLOSE="b",Le.ERROR="c",Le.MESSAGE="d",$t.prototype.listen=$t.prototype.N,Xn.prototype.listenOnce=Xn.prototype.O,Xn.prototype.getLastError=Xn.prototype.La,Xn.prototype.getLastErrorCode=Xn.prototype.Da,Xn.prototype.getStatus=Xn.prototype.ba,Xn.prototype.getResponseJson=Xn.prototype.Qa,Xn.prototype.getResponseText=Xn.prototype.ga,Xn.prototype.send=Xn.prototype.ea;var Lr=je,Mr=xe,Fr=Ie,Ur=Kn,Vr=Re,qr=Xn,Br=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Br.o=-1;var Kr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Gr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(j.c)(e,t),e}(Error),zr=new C.b("@firebase/firestore");function Qr(){return zr.logLevel}function Hr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zr.logLevel<=C.a.DEBUG){var r=e.map(Xr);zr.debug.apply(zr,Object(j.f)(["Firestore (8.7.0): "+t],r))}}function Wr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zr.logLevel<=C.a.ERROR){var r=e.map(Xr);zr.error.apply(zr,Object(j.f)(["Firestore (8.7.0): "+t],r))}}function Yr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zr.logLevel<=C.a.WARN){var r=e.map(Xr);zr.warn.apply(zr,Object(j.f)(["Firestore (8.7.0): "+t],r))}}function Xr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(Xd){return t}}function $r(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.7.0) INTERNAL ASSERTION FAILED: "+t;throw Wr(e),new Error(e)}function Jr(t,e){t||$r()}function Zr(t,e){return t}function ti(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var ei=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=ti(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ni(t,e){return t<e?-1:t>e?1:0}function ri(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function ii(t){return t+"\0"}var oi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Gr(Kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Gr(Kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Gr(Kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Gr(Kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?ni(this.nanoseconds,t.nanoseconds):ni(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),si=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new oi(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function ai(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ui(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ci(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var hi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&$r(),void 0===n?n=t.length-e:n>t.length-e&&$r(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),li=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.emptyPath=function(){return new e([])},e}(hi),fi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,di=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return fi.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Gr(Kr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Gr(Kr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Gr(Kr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(hi),pi=function(){function t(t){this.fields=t,t.sort(di.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return ri(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),yi=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.binaryString)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return ni(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();yi.EMPTY_BYTE_STRING=new yi("");var gi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vi(t){if(Jr(!!t),"string"==typeof t){var e=0,n=gi.exec(t);if(Jr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:mi(t.seconds),nanos:mi(t.nanos)}}function mi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function bi(t){return"string"==typeof t?yi.fromBase64String(t):yi.fromUint8Array(t)}function wi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ti(t){var e=t.mapValue.fields.__previous_value__;return wi(e)?Ti(e):e}function Ii(t){var e=vi(t.mapValue.fields.__local_write_time__.timestampValue);return new oi(e.seconds,e.nanos)}function Ei(t){return null==t}function _i(t){return 0===t&&1/t==-1/0}function Oi(t){return"number"==typeof t&&Number.isInteger(t)&&!_i(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Si=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(li.fromString(e))},t.fromName=function(e){return new t(li.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===li.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return li.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new li(e.slice()))},t}();function Di(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?wi(t)?4:10:$r()}function Ni(t,e){var n=Di(t);if(n!==Di(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ii(t).isEqual(Ii(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=vi(t.timestampValue),r=vi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return bi(t.bytesValue).isEqual(bi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return mi(t.geoPointValue.latitude)===mi(e.geoPointValue.latitude)&&mi(t.geoPointValue.longitude)===mi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return mi(t.integerValue)===mi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=mi(t.doubleValue),r=mi(e.doubleValue);return n===r?_i(n)===_i(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ri(t.arrayValue.values||[],e.arrayValue.values||[],Ni);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ai(n)!==ai(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ni(n[i],r[i])))return!1;return!0}(t,e);default:return $r()}}function Ai(t,e){return void 0!==(t.values||[]).find(function(t){return Ni(t,e)})}function ki(t,e){var n=Di(t),r=Di(e);if(n!==r)return ni(n,r);switch(n){case 0:return 0;case 1:return ni(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=mi(t.integerValue||t.doubleValue),r=mi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ji(t.timestampValue,e.timestampValue);case 4:return ji(Ii(t),Ii(e));case 5:return ni(t.stringValue,e.stringValue);case 6:return function(t,e){var n=bi(t),r=bi(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ni(n[i],r[i]);if(0!==o)return o}return ni(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ni(mi(t.latitude),mi(e.latitude));return 0!==n?n:ni(mi(t.longitude),mi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ki(n[i],r[i]);if(o)return o}return ni(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=ni(r[s],o[s]);if(0!==a)return a;var u=ki(n[r[s]],i[o[s]]);if(0!==u)return u}return ni(r.length,o.length)}(t.mapValue,e.mapValue);default:throw $r()}}function ji(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ni(t,e);var n=vi(t),r=vi(e),i=ni(n.seconds,r.seconds);return 0!==i?i:ni(n.nanos,r.nanos)}function xi(t){return Ci(t)}function Ci(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=vi(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?bi(t.bytesValue).toBase64():"referenceValue"in t?Si.fromName(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Ci(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Ci(t.fields[o])}return e+"}"}(t.mapValue):$r();var e}function Ri(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Pi(t){return!!t&&"integerValue"in t}function Li(t){return!!t&&"arrayValue"in t}function Mi(t){return!!t&&"nullValue"in t}function Fi(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ui(t){return!!t&&"mapValue"in t}function Vi(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},vi(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return ui(t.mapValue.fields,function(t,n){return e.mapValue.fields[t]=Vi(n)}),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Vi(t.arrayValue.values[r]);return n}return Object.assign({},t)}var qi=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Ui(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Vi(e)},t.prototype.setAll=function(t){var e=this,n=di.emptyPath(),r={},i=[];t.forEach(function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Vi(t):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Ui(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Ni(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Ui(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){ui(e,function(e,n){return t[e]=n});for(var r=0,i=n;r<i.length;r++)delete t[i[r]]},t.prototype.clone=function(){return new t(Vi(this.value))},t}();function Bi(t){var e=[];return ui(t.fields,function(t,n){var r=new di([t]);if(Ui(n)){var i=Bi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new pi(e)}var Ki=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,si.min(),qi.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,qi.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,qi.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=qi.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=qi.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Gi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function zi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Gi(t,e,n,r,i,o,s)}function Qi(t){var e=Zr(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.canonicalString()+t.op.toString()+xi(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.canonicalString()+t.dir}(t)}).join(","),Ei(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=oo(e.startAt)),e.endAt&&(n+="|ub:",n+=oo(e.endAt)),e.h=n}return e.h}function Hi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!ao(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Ni(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!co(t.startAt,e.startAt)&&co(t.endAt,e.endAt)}function Wi(t){return Si.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Yi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(j.c)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Xi(t,n,r):"array-contains"===n?new to(t,r):"in"===n?new eo(t,r):"not-in"===n?new no(t,r):"array-contains-any"===n?new ro(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new $i(t,n):new Ji(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(ki(e,this.value)):null!==e&&Di(this.value)===Di(e)&&this.m(ki(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return $r()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Xi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Si.fromName(r.referenceValue),i}return Object(j.c)(e,t),e.prototype.matches=function(t){var e=Si.comparator(t.key,this.key);return this.m(e)},e}(Yi),$i=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Zi(0,n),r}return Object(j.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Yi),Ji=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Zi(0,n),r}return Object(j.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Yi);function Zi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Si.fromName(t.referenceValue)})}var to=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(j.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Li(e)&&Ai(e.arrayValue,this.value)},e}(Yi),eo=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(j.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Ai(this.value.arrayValue,e)},e}(Yi),no=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(j.c)(e,t),e.prototype.matches=function(t){if(Ai(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Ai(this.value.arrayValue,e)},e}(Yi),ro=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(j.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Li(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Ai(e.value.arrayValue,t)})},e}(Yi),io=function(t,e){this.position=t,this.before=e};function oo(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return xi(t)}).join(",")}var so=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ao(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function uo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Si.comparator(Si.fromName(s.referenceValue),n.key):ki(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function co(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ni(t.position[n],e.position[n]))return!1;return!0}var ho=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null};function lo(t,e,n,r,i,o,s,a){return new ho(t,e,n,r,i,o,s,a)}function fo(t){return new ho(t)}function po(t){return!Ei(t.limit)&&"F"===t.limitType}function yo(t){return!Ei(t.limit)&&"L"===t.limitType}function go(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function vo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function mo(t){return null!==t.collectionGroup}function bo(t){var e=Zr(t);if(null===e.p){e.p=[];var n=vo(e),r=go(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new so(n)),e.p.push(new so(di.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new so(di.keyField(),u))}}}return e.p}function wo(t){var e=Zr(t);if(!e.T)if("F"===e.limitType)e.T=zi(e.path,e.collectionGroup,bo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=bo(e);r<i.length;r++){var o=i[r];n.push(new so(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new io(e.endAt.position,!e.endAt.before):null,a=e.startAt?new io(e.startAt.position,!e.startAt.before):null;e.T=zi(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.T}function To(t,e,n){return new ho(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Io(t,e){return Hi(wo(t),wo(e))&&t.limitType===e.limitType}function Eo(t){return Qi(wo(t))+"|lt:"+t.limitType}function _o(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.canonicalString()+" "+e.op+" "+xi(e.value);var e}).join(", ")+"]"),Ei(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+oo(t.startAt)),t.endAt&&(e+=", endAt: "+oo(t.endAt)),"Target("+e+")"}(wo(t))+"; limitType="+t.limitType+")"}function Oo(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Si.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!uo(t.startAt,bo(t),e)||t.endAt&&uo(t.endAt,bo(t),e))}(t,e)}function So(t){return function(e,n){for(var r=!1,i=0,o=bo(t);i<o.length;i++){var s=o[i],a=Do(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Do(t,e,n){var r=t.field.isKeyField()?Si.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?ki(r,i):$r()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return $r()}}function No(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_i(e)?"-0":e}}function Ao(t){return{integerValue:""+t}}function ko(t,e){return Oi(e)?Ao(e):No(t,e)}var jo=function(){this._=void 0};function xo(t,e,n){return t instanceof Po?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Lo?Mo(t,e):t instanceof Fo?Uo(t,e):function(t,e){var n=Ro(t,e),r=qo(n)+qo(t.A);return Pi(n)&&Pi(t.A)?Ao(r):No(t.R,r)}(t,e)}function Co(t,e,n){return t instanceof Lo?Mo(t,e):t instanceof Fo?Uo(t,e):n}function Ro(t,e){return t instanceof Vo?Pi(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Po=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.c)(e,t),e}(jo),Lo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(j.c)(e,t),e}(jo);function Mo(t,e){for(var n=Bo(e),r=function(t){n.some(function(e){return Ni(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Fo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(j.c)(e,t),e}(jo);function Uo(t,e){for(var n=Bo(e),r=function(t){n=n.filter(function(e){return!Ni(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Vo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Object(j.c)(e,t),e}(jo);function qo(t){return mi(t.integerValue||t.doubleValue)}function Bo(t){return Li(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ko=function(t,e){this.field=t,this.transform=e},Go=function(t,e){this.version=t,this.transformResults=e},zo=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Qo(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Ho=function(){};function Wo(t,e,n){t instanceof Zo?function(t,e,n){var r=t.value.clone(),i=ns(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof ts?function(t,e,n){if(Qo(t.precondition,e)){var r=ns(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(es(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Yo(t,e,n){t instanceof Zo?function(t,e,n){if(Qo(t.precondition,e)){var r=t.value.clone(),i=rs(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Jo(e),r).setHasLocalMutations()}}(t,e,n):t instanceof ts?function(t,e,n){if(Qo(t.precondition,e)){var r=rs(t.fieldTransforms,n,e),i=e.data;i.setAll(es(t)),i.setAll(r),e.convertToFoundDocument(Jo(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Qo(t.precondition,e)&&e.convertToNoDocument(si.min())}(t,e)}function Xo(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Ro(o.transform,s||null);null!=a&&(null==n&&(n=qi.empty()),n.set(o.field,a))}return n||null}function $o(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&ri(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Lo&&e instanceof Lo||t instanceof Fo&&e instanceof Fo?ri(t.elements,e.elements,Ni):t instanceof Vo&&e instanceof Vo?Ni(t.A,e.A):t instanceof Po&&e instanceof Po}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Jo(t){return t.isFoundDocument()?t.version:si.min()}var Zo=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(j.c)(e,t),e}(Ho),ts=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Object(j.c)(e,t),e}(Ho);function es(t){var e=new Map;return t.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}}),e}function ns(t,e,n){var r=new Map;Jr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Co(s,a,n[i]))}return r}function rs(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,xo(a,u,e))}return r}var is,os,ss=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(j.c)(e,t),e}(Ho),as=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(j.c)(e,t),e}(Ho),us=function(t){this.count=t};function cs(t){switch(t){case Kr.OK:return $r();case Kr.CANCELLED:case Kr.UNKNOWN:case Kr.DEADLINE_EXCEEDED:case Kr.RESOURCE_EXHAUSTED:case Kr.INTERNAL:case Kr.UNAVAILABLE:case Kr.UNAUTHENTICATED:return!1;case Kr.INVALID_ARGUMENT:case Kr.NOT_FOUND:case Kr.ALREADY_EXISTS:case Kr.PERMISSION_DENIED:case Kr.FAILED_PRECONDITION:case Kr.ABORTED:case Kr.OUT_OF_RANGE:case Kr.UNIMPLEMENTED:case Kr.DATA_LOSS:return!0;default:return $r()}}function hs(t){if(void 0===t)return Wr("GRPC error has no .code"),Kr.UNKNOWN;switch(t){case is.OK:return Kr.OK;case is.CANCELLED:return Kr.CANCELLED;case is.UNKNOWN:return Kr.UNKNOWN;case is.DEADLINE_EXCEEDED:return Kr.DEADLINE_EXCEEDED;case is.RESOURCE_EXHAUSTED:return Kr.RESOURCE_EXHAUSTED;case is.INTERNAL:return Kr.INTERNAL;case is.UNAVAILABLE:return Kr.UNAVAILABLE;case is.UNAUTHENTICATED:return Kr.UNAUTHENTICATED;case is.INVALID_ARGUMENT:return Kr.INVALID_ARGUMENT;case is.NOT_FOUND:return Kr.NOT_FOUND;case is.ALREADY_EXISTS:return Kr.ALREADY_EXISTS;case is.PERMISSION_DENIED:return Kr.PERMISSION_DENIED;case is.FAILED_PRECONDITION:return Kr.FAILED_PRECONDITION;case is.ABORTED:return Kr.ABORTED;case is.OUT_OF_RANGE:return Kr.OUT_OF_RANGE;case is.UNIMPLEMENTED:return Kr.UNIMPLEMENTED;case is.DATA_LOSS:return Kr.DATA_LOSS;default:return $r()}}(os=is||(is={}))[os.OK=0]="OK",os[os.CANCELLED=1]="CANCELLED",os[os.UNKNOWN=2]="UNKNOWN",os[os.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",os[os.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",os[os.NOT_FOUND=5]="NOT_FOUND",os[os.ALREADY_EXISTS=6]="ALREADY_EXISTS",os[os.PERMISSION_DENIED=7]="PERMISSION_DENIED",os[os.UNAUTHENTICATED=16]="UNAUTHENTICATED",os[os.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",os[os.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",os[os.ABORTED=10]="ABORTED",os[os.OUT_OF_RANGE=11]="OUT_OF_RANGE",os[os.UNIMPLEMENTED=12]="UNIMPLEMENTED",os[os.INTERNAL=13]="INTERNAL",os[os.UNAVAILABLE=14]="UNAVAILABLE",os[os.DATA_LOSS=15]="DATA_LOSS";var ls=function(){function t(t,e){this.comparator=t,this.root=e||ds.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ds.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ds.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new fs(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new fs(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new fs(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new fs(this.root,t,this.comparator,!0)},t}(),fs=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),ds=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw $r();if(this.right.isRed())throw $r();var t=this.left.check();if(t!==this.right.check())throw $r();return t+(this.isRed()?0:1)},t}();ds.EMPTY=null,ds.RED=!0,ds.BLACK=!1,ds.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw $r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw $r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw $r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw $r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw $r()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new ds(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var ps=function(){function t(t){this.comparator=t,this.data=new ls(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new ys(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new ys(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),ys=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),gs=new ls(Si.comparator);function vs(){return gs}var ms=new ls(Si.comparator);function bs(){return ms}var ws=new ls(Si.comparator);function Ts(){return ws}var Is=new ps(Si.comparator);function Es(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Is,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var _s=new ps(ni);function Os(){return _s}var Ss=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Ds.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(si.min(),r,Os(),vs(),Es())},t}(),Ds=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(yi.EMPTY_BYTE_STRING,n,Es(),Es(),Es())},t}(),Ns=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},As=function(t,e){this.targetId=t,this.V=e},ks=function(t,e,n,r){void 0===n&&(n=yi.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},js=function(){function t(){this.S=0,this.D=Rs(),this.C=yi.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Es(),e=Es(),n=Es();return this.D.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:$r()}}),new Ds(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Rs()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),xs=function(){function t(t){this.W=t,this.G=new Map,this.H=vs(),this.J=Cs(),this.Y=new ps(ni)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.tt(r=o[i],t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:$r()}})},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach(function(t,r){n.st(r)&&e(r)})},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Wi(i))if(0===n){var o=new Si(i.path);this.tt(e,o,Ki.newNoDocument(o,si.min()))}else Jr(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach(function(r,i){var o=e.ot(i);if(o){if(r.current&&Wi(o.target)){var s=new Si(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Ki.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}});var r=Es();this.J.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Ss(t,n,this.Y,this.H,r);return this.H=vs(),this.J=Cs(),this.Y=new ps(ni),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new js,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new ps(ni),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Hr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new js),this.W.getRemoteKeysForTarget(t).forEach(function(n){e.tt(t,n,null)})},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Cs(){return new ls(Si.comparator)}function Rs(){return new ls(Si.comparator)}var Ps={asc:"ASCENDING",desc:"DESCENDING"},Ls={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ms=function(t,e){this.databaseId=t,this.I=e};function Fs(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Us(t,e){return t.I?e.toBase64():e.toUint8Array()}function Vs(t,e){return Fs(t,e.toTimestamp())}function qs(t){return Jr(!!t),si.fromTimestamp(function(t){var e=vi(t);return new oi(e.seconds,e.nanos)}(t))}function Bs(t,e){return function(t){return new li(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Ks(t){var e=li.fromString(t);return Jr(da(e)),e}function Gs(t,e){return Bs(t.databaseId,e.path)}function zs(t,e){var n=Ks(e);if(n.get(1)!==t.databaseId.projectId)throw new Gr(Kr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Gr(Kr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Si(Ys(n))}function Qs(t,e){return Bs(t.databaseId,e)}function Hs(t){var e=Ks(t);return 4===e.length?li.emptyPath():Ys(e)}function Ws(t){return new li(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ys(t){return Jr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Xs(t,e,n){return{name:Gs(t,e),fields:n.value.mapValue.fields}}function $s(t,e,n){var r=zs(t,e.name),i=qs(e.updateTime),o=new qi({mapValue:{fields:e.fields}}),s=Ki.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function Js(t,e){var n;if(e instanceof Zo)n={update:Xs(t,e.key,e.value)};else if(e instanceof ss)n={delete:Gs(t,e.key)};else if(e instanceof ts)n={update:Xs(t,e.key,e.data),updateMask:fa(e.fieldMask)};else{if(!(e instanceof as))return $r();n={verify:Gs(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Po)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Lo)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Fo)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Vo)return{fieldPath:e.field.canonicalString(),increment:n.A};throw $r()}(0,t)})),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Vs(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:$r()}(t,e.precondition)),n}function Zs(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?zo.updateTime(qs(t.updateTime)):void 0!==t.exists?zo.exists(t.exists):zo.none()}(e.currentDocument):zo.none(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(Jr("REQUEST_TIME"===e.setToServerValue),n=new Po):"appendMissingElements"in e?n=new Lo(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Fo(e.removeAllFromArray.values||[]):"increment"in e?n=new Vo(t,e.increment):$r();var r=di.fromServerFormat(e.fieldPath);return new Ko(r,n)}(t,e)}):[];if(e.update){var i=zs(t,e.update.name),o=new qi({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new pi((t.fieldPaths||[]).map(function(t){return di.fromServerFormat(t)}))}(e.updateMask);return new ts(i,o,s,n,r)}return new Zo(i,o,n,r)}if(e.delete){var a=zs(t,e.delete);return new ss(a,n)}if(e.verify){var u=zs(t,e.verify);return new as(u,n)}return $r()}function ta(t,e){return{documents:[Qs(t,e.path)]}}function ea(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Qs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Qs(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Fi(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NAN"}};if(Mi(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Fi(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NOT_NAN"}};if(Mi(t.value))return{unaryFilter:{field:ua(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ua(t.field),op:aa(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:ua(t.field),direction:sa(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||Ei(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=ia(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ia(e.endAt)),n}function na(t){var e=Hs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Jr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=ra(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(t){return function(t){return new so(ca(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var u=null;n.limit&&(u=function(t){var e;return Ei(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=oa(n.startAt));var h=null;return n.endAt&&(h=oa(n.endAt)),lo(e,i,a,s,u,"F",c,h)}function ra(t){return t?void 0!==t.unaryFilter?[la(t)]:void 0!==t.fieldFilter?[ha(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return ra(t)}).reduce(function(t,e){return t.concat(e)}):$r():[]}function ia(t){return{before:t.before,values:t.position}}function oa(t){return new io(t.values||[],!!t.before)}function sa(t){return Ps[t]}function aa(t){return Ls[t]}function ua(t){return{fieldPath:t.canonicalString()}}function ca(t){return di.fromServerFormat(t.fieldPath)}function ha(t){return Yi.create(ca(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return $r()}}(t.fieldFilter.op),t.fieldFilter.value)}function la(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ca(t.unaryFilter.field);return Yi.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ca(t.unaryFilter.field);return Yi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ca(t.unaryFilter.field);return Yi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ca(t.unaryFilter.field);return Yi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return $r()}}function fa(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}}function da(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function pa(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=ga(e)),e=ya(t.get(n),e);return ga(e)}function ya(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function ga(t){return t+"\x01\x01"}function va(t){var e=t.length;if(Jr(e>=2),2===e)return Jr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),li.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&$r(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:$r()}o=s+2}return new li(r)}var ma=function(t,e){this.seconds=t,this.nanoseconds=e},ba=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ba.store="owner",ba.key="owner";var wa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};wa.store="mutationQueues",wa.keyPath="userId";var Ta=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ta.store="mutations",Ta.keyPath="batchId",Ta.userMutationsIndex="userMutationsIndex",Ta.userMutationsKeyPath=["userId","batchId"];var Ia=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,pa(e)]},t.key=function(t,e,n){return[t,pa(e),n]},t}();Ia.store="documentMutations",Ia.PLACEHOLDER=new Ia;var Ea=function(t,e){this.path=t,this.readTime=e},_a=function(t,e){this.path=t,this.version=e},Oa=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Oa.store="remoteDocuments",Oa.readTimeIndex="readTimeIndex",Oa.readTimeIndexPath="readTime",Oa.collectionReadTimeIndex="collectionReadTimeIndex",Oa.collectionReadTimeIndexPath=["parentPath","readTime"];var Sa=function(t){this.byteSize=t};Sa.store="remoteDocumentGlobal",Sa.key="remoteDocumentGlobalKey";var Da=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Da.store="targets",Da.keyPath="targetId",Da.queryTargetsIndexName="queryTargetsIndex",Da.queryTargetsKeyPath=["canonicalId","targetId"];var Na=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Na.store="targetDocuments",Na.keyPath=["targetId","path"],Na.documentTargetsIndex="documentTargetsIndex",Na.documentTargetsKeyPath=["path","targetId"];var Aa=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Aa.key="targetGlobalKey",Aa.store="targetGlobal";var ka=function(t,e){this.collectionId=t,this.parent=e};ka.store="collectionParents",ka.keyPath=["collectionId","parent"];var ja=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};ja.store="clientMetadata",ja.keyPath="clientId";var xa=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};xa.store="bundles",xa.keyPath="bundleId";var Ca=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Ca.store="namedQueries",Ca.keyPath="name";var Ra=Object(j.f)(Object(j.f)([],Object(j.f)(Object(j.f)([],Object(j.f)(Object(j.f)([],Object(j.f)(Object(j.f)([],[wa.store,Ta.store,Ia.store,Oa.store,Da.store,ba.store,Aa.store,Na.store]),[ja.store])),[Sa.store])),[ka.store])),[xa.store,Ca.store]),Pa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",La=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},t}(),Ma=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Fa=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&$r(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Ua=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Ma,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Ba(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Ha(e.target.error);n.ft.reject(new Ba(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Ba(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Hr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ga(e)},t}(),Va=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Object(x.i)())&&Wr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Hr("SimpleDb","Removing database:",t),za(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Object(x.i)(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Object(j.b)(this,void 0,void 0,function(){var e,n=this;return Object(j.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Hr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Ba(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Gr(Kr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Ba(t,n))},i.onupgradeneeded=function(t){Hr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.wt.Rt(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Hr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}})})},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(j.b)(this,void 0,void 0,function(){var i,o,s,a,u;return Object(j.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Object(j.d)(this,function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Ua.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),Fa.reject(t)}).toPromise(),u={},s.catch(function(){}),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return Hr("SimpleDb","Transaction failed with error:",(c=l.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),qa=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return za(this.Pt.delete())},t}(),Ba=function(t){function e(e,n){var r=this;return(r=t.call(this,Kr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(j.c)(e,t),e}(Gr);function Ka(t){return"IndexedDbTransactionError"===t.name}var Ga=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Hr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Hr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),za(n)},t.prototype.add=function(t){return Hr("SimpleDb","ADD",this.store.name,t,t),za(this.store.add(t))},t.prototype.get=function(t){var e=this;return za(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Hr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Hr("SimpleDb","DELETE",this.store.name,t),za(this.store.delete(t))},t.prototype.count=function(){return Hr("SimpleDb","COUNT",this.store.name),za(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Ft=function(t,e){Hr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,function(t,e,n){return n.delete()})},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Fa(function(n,r){e.onerror=function(t){var e=Ha(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.xt=function(t,e){var n=[];return new Fa(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new qa(i),s=e(i.primaryKey,i.value,o);if(s instanceof Fa){var a=s.catch(function(t){return o.done(),Fa.reject(t)});n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return Fa.waitFor(n)})},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function za(t){return new Fa(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Ha(t.target.error);n(e)}})}var Qa=!1;function Ha(t){var e=Va._t(Object(x.i)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Gr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Qa||(Qa=!0,setTimeout(function(){throw r},0)),r}}return t}var Wa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Object(j.c)(e,t),e}(La);function Ya(t,e){var n=Zr(t);return Va.It(n.Mt,e)}var Xa=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Wo(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Yo(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Yo(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach(function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(si.min())})},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Es())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ri(this.mutations,t.mutations,function(t,e){return $o(t,e)})&&ri(this.baseMutations,t.baseMutations,function(t,e){return $o(t,e)})},t}(),$a=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Jr(e.mutations.length===r.length);for(var i=Ts(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Ja=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=si.min()),void 0===o&&(o=si.min()),void 0===s&&(s=yi.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Za=function(t){this.Lt=t};function tu(t,e){if(e.document)return $s(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Si.fromSegments(e.noDocument.path),r=ou(e.noDocument.readTime),i=Ki.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Si.fromSegments(e.unknownDocument.path);return r=ou(e.unknownDocument.version),Ki.newUnknownDocument(o,r)}return $r()}function eu(t,e,n){var r=nu(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Gs(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Fs(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new Oa(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=iu(e.version);return s=e.hasCommittedMutations,new Oa(null,new Ea(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=iu(e.version);return new Oa(new _a(c,h),null,null,!0,r,i)}return $r()}function nu(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ru(t){var e=new oi(t[0],t[1]);return si.fromTimestamp(e)}function iu(t){var e=t.toTimestamp();return new ma(e.seconds,e.nanoseconds)}function ou(t){var e=new oi(t.seconds,t.nanoseconds);return si.fromTimestamp(e)}function su(t,e){for(var n=(e.baseMutations||[]).map(function(e){return Zs(t.Lt,e)}),r=0;r<e.mutations.length-1;++r)r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(e.mutations[r].updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r);var i=e.mutations.map(function(e){return Zs(t.Lt,e)}),o=oi.fromMillis(e.localWriteTimeMs);return new Xa(e.batchId,o,n,i)}function au(t){var e,n,r=ou(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ou(t.lastLimboFreeSnapshotVersion):si.min();return void 0!==t.query.documents?(Jr(1===(n=t.query).documents.length),e=wo(fo(Hs(n.documents[0])))):e=function(t){return wo(na(t))}(t.query),new Ja(e,t.targetId,0,t.lastListenSequenceNumber,r,i,yi.fromBase64String(t.resumeToken))}function uu(t,e){var n,r=iu(e.snapshotVersion),i=iu(e.lastLimboFreeSnapshotVersion);n=Wi(e.target)?ta(t.Lt,e.target):ea(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Da(e.targetId,Qi(e.target),r,o,e.sequenceNumber,i,n)}function cu(t){var e=na({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?To(e,e.limit,"L"):e}var hu=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return lu(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:ou(e.createTime),version:e.version};var e})},t.prototype.saveBundleMetadata=function(t,e){return lu(t).put({bundleId:(n=e).id,createTime:iu(qs(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return fu(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:cu(e.bundledQuery),readTime:ou(e.readTime)};var e})},t.prototype.saveNamedQuery=function(t,e){return fu(t).put(function(t){return{name:t.name,readTime:iu(qs(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function lu(t){return Ya(t,xa.store)}function fu(t){return Ya(t,Ca.store)}var du=function(){function t(){this.Bt=new pu}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Fa.resolve()},t.prototype.getCollectionParents=function(t,e){return Fa.resolve(this.Bt.getEntries(e))},t}(),pu=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new ps(li.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new ps(li.comparator)).toArray()},t}(),yu=function(){function t(){this.qt=new pu}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.qt.add(e)});var o={collectionId:r,parent:pa(i)};return gu(t).put(o)}return Fa.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ii(e),""],!1,!0);return gu(t).Nt(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(va(o.parent))}return n})},t}();function gu(t){return Ya(t,ka.store)}var vu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mu=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function bu(t,e,n){var r=t.store(Ta.store),i=t.store(Ia.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){Jr(1===a)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=Ia.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Fa.waitFor(o).next(function(){return c})}function wu(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw $r();e=t.noDocument}return JSON.stringify(e).length}mu.DEFAULT_COLLECTION_PERCENTILE=10,mu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mu.DEFAULT=new mu(41943040,mu.DEFAULT_COLLECTION_PERCENTILE,mu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mu.DISABLED=new mu(-1,0,0);var Tu=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Jr(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Eu(t).$t({index:Ta.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=_u(t),s=Eu(t);return s.add({}).next(function(a){Jr("number"==typeof a);for(var u=new Xa(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Js(t.Lt,e)}),i=n.mutations.map(function(e){return Js(t.Lt,e)});return new Ta(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new ps(function(t,e){return ni(t.canonicalString(),e.canonicalString())}),f=0,d=r;f<d.length;f++){var p=d[f],y=Ia.key(i.userId,p.key.path,a);l=l.add(p.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,Ia.PLACEHOLDER))}return l.forEach(function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(function(){i.Kt[a]=u.keys()}),Fa.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Eu(t).get(e).next(function(t){return t?(Jr(t.userId===n.userId),su(n.R,t)):null})},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Fa.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Eu(t).$t({index:Ta.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Jr(e.batchId>=r),o=su(n.R,e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Eu(t).$t({index:Ta.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Eu(t).Nt(Ta.userMutationsIndex,n).next(function(t){return t.map(function(t){return su(e.R,t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Ia.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return _u(t).$t({range:i},function(r,i,s){var a=r[0],u=r[2],c=va(r[1]);if(a===n.userId&&e.path.isEqual(c))return Eu(t).get(u).next(function(t){if(!t)throw $r();Jr(t.userId===n.userId),o.push(su(n.R,t))});s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ps(ni),i=[];return e.forEach(function(e){var o=Ia.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=_u(t).$t({range:s},function(t,i,o){var s=t[0],a=t[2],u=va(t[1]);s===n.userId&&e.path.isEqual(u)?r=r.add(a):o.done()});i.push(a)}),Fa.waitFor(i).next(function(){return n.Wt(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ia.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new ps(ni);return _u(t).$t({range:s},function(t,e,o){var s=t[0],u=t[2],c=va(t[1]);s===n.userId&&r.isPrefixOf(c)?c.length===i&&(a=a.add(u)):o.done()}).next(function(){return n.Wt(t,a)})},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Eu(t).get(e).next(function(t){if(null===t)throw $r();Jr(t.userId===n.userId),r.push(su(n.R,t))}))}),Fa.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return bu(t.Mt,this.userId,e).next(function(r){return t.addOnCommittedListener(function(){n.Gt(e.batchId)}),Fa.forEach(r,function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)})})},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Fa.resolve();var r=IDBKeyRange.lowerBound(Ia.prefixForUser(e.userId)),i=[];return _u(t).$t({range:r},function(t,n,r){if(t[0]===e.userId){var o=va(t[1]);i.push(o)}else r.done()}).next(function(){Jr(0===i.length)})})},t.prototype.containsKey=function(t,e){return Iu(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Ou(t).get(this.userId).next(function(t){return t||new wa(e.userId,-1,"")})},t}();function Iu(t,e,n){var r=Ia.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return _u(t).$t({range:o,kt:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function Eu(t){return Ya(t,Ta.store)}function _u(t){return Ya(t,Ia.store)}function Ou(t){return Ya(t,wa.store)}var Su=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Du=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next(function(n){var r=new Su(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(t){return si.fromTimestamp(new oi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)})},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next(function(){return n.Xt(t).next(function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)})})},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Nu(t).delete(e.targetId)}).next(function(){return n.Xt(t)}).next(function(e){return Jr(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Nu(t).$t(function(s,a){var u=au(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))}).next(function(){return Fa.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){return Nu(t).$t(function(t,n){var r=au(n);e(r)})},t.prototype.Xt=function(t){return Au(t).get(Aa.key).next(function(t){return Jr(null!==t),t})},t.prototype.Zt=function(t,e){return Au(t).put(Aa.key,e)},t.prototype.te=function(t,e){return Nu(t).put(uu(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next(function(t){return t.targetCount})},t.prototype.getTargetData=function(t,e){var n=Qi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Nu(t).$t({range:r,index:Da.queryTargetsIndexName},function(t,n,r){var o=au(n);Hi(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=ku(t);return e.forEach(function(e){var s=pa(e.path);i.push(o.put(new Na(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))}),Fa.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=ku(t);return Fa.forEach(e,function(e){var o=pa(e.path);return Fa.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=ku(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ku(t),i=Es();return r.$t({range:n,kt:!0},function(t,e,n){var r=va(t[1]),o=new Si(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=pa(e.path),r=IDBKeyRange.bound([n],[ii(n)],!1,!0),i=0;return ku(t).$t({index:Na.documentTargetsIndex,kt:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.lt=function(t,e){return Nu(t).get(e).next(function(t){return t?au(t):null})},t}();function Nu(t){return Ya(t,Da.store)}function Au(t){return Ya(t,Aa.store)}function ku(t){return Ya(t,Na.store)}function ju(t){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(e){if(t.code!==Kr.FAILED_PRECONDITION||t.message!==Pa)throw t;return Hr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function xu(t,e){var n=t[1],r=e[1],i=ni(t[0],e[0]);return 0===i?ni(n,r):i}var Cu=function(){function t(t){this.ne=t,this.buffer=new ps(xu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();xu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ru=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Hr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,function(){return Object(j.b)(e,void 0,void 0,function(){var e;return Object(j.d)(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Ka(e=n.sent())?(Hr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,ju(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}})})})},t}(),Pu=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Fa.resolve(Br.o);var r=new Cu(e);return this.ae.forEachTarget(t,function(t){return r.re(t.sequenceNumber)}).next(function(){return n.ae.le(t,function(t){return r.re(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Hr("LruGarbageCollector","Garbage collection skipped; disabled"),Fa.resolve(vu)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(Hr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),vu):n.fe(t,e)})},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>c.params.maximumSequenceNumbersToCollect?(Hr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)}).next(function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)}).next(function(t){return u=Date.now(),Qr()<=C.a.DEBUG&&Hr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),Fa.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),Lu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Pu(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.de=function(t){var e=0;return this.le(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,function(t,n){return e(n)})},t.prototype.addReference=function(t,e,n){return Mu(t,n)},t.prototype.removeReference=function(t,e,n){return Mu(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Mu(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return Ou(t).Ot(function(r){return Iu(t,r,e).next(function(t){return t&&(n=!0),Fa.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,function(s,a){if(a<=e){var u=n._e(t,s).next(function(e){if(!e)return o++,r.getEntry(t,s).next(function(){return r.removeEntry(s),ku(t).delete([0,pa(s.path)])})});i.push(u)}}).next(function(){return Fa.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Mu(t,e)},t.prototype.we=function(t,e){var n,r=ku(t),i=Br.o;return r.$t({index:Na.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Br.o&&e(new Si(va(n)),i),i=s,n=o):i=Br.o}).next(function(){i!==Br.o&&e(new Si(va(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Mu(t,e){return ku(t).put(function(t,e){return new Na(0,pa(t.path),e)}(e,t.currentSequenceNumber))}var Fu=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.equalsFn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ui(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.isEmpty=function(){return ci(this.inner)},t}(),Uu=function(){function t(){this.changes=new Fu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:si.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Ki.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Fa.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Vu=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Ku(t).put(Gu(e),n)},t.prototype.removeEntry=function(t,e){var n=Ku(t),r=Gu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.me(t,r)})},t.prototype.getEntry=function(t,e){var n=this;return Ku(t).get(Gu(e)).next(function(t){return n.ye(e,t)})},t.prototype.ge=function(t,e){var n=this;return Ku(t).get(Gu(e)).next(function(t){return{document:n.ye(e,t),size:wu(t)}})},t.prototype.getEntries=function(t,e){var n=this,r=vs();return this.pe(t,e,function(t,e){var i=n.ye(t,e);r=r.insert(t,i)}).next(function(){return r})},t.prototype.Ee=function(t,e){var n=this,r=vs(),i=new ls(Si.comparator);return this.pe(t,e,function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,wu(e))}).next(function(){return{documents:r,Te:i}})},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Fa.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Ku(t).$t({range:r},function(t,e,r){for(var s=Si.fromSegments(t);o&&Si.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=vs(),o=e.path.length+1,s={};if(n.isEqual(si.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=nu(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Oa.collectionReadTimeIndex}return Ku(t).$t(s,function(t,n,s){if(t.length===o){var a=tu(r.R,n);e.path.isPrefixOf(a.key.path)?Oo(e,a)&&(i=i.insert(a.key,a)):s.done()}}).next(function(){return i})},t.prototype.newChangeBuffer=function(t){return new qu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Bu(t).get(Sa.key).next(function(t){return Jr(!!t),t})},t.prototype.me=function(t,e){return Bu(t).put(Sa.key,e)},t.prototype.ye=function(t,e){if(e){var n=tu(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(si.min()))return n}return Ki.newInvalidDocument(t)},t}(),qu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Fu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(j.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new ps(function(t,e){return ni(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=eu(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=wu(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=eu(e.Ie.R,Ki.newNoDocument(o,si.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))}),i.forEach(function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))}),n.push(this.Ie.updateMetadata(t,r)),Fa.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next(function(t){return n.Ae.set(e,t.size),t.document})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next(function(t){var e=t.documents;return t.Te.forEach(function(t,e){n.Ae.set(t,e)}),e})},e}(Uu);function Bu(t){return Ya(t,Sa.store)}function Ku(t){return Ya(t,Oa.store)}function Gu(t){return t.path.toArray()}var zu=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Jr(n<r&&n>=0&&r<=11);var o=new Ua("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(ba.store)}(t),function(t){t.createObjectStore(wa.store,{keyPath:wa.keyPath}),t.createObjectStore(Ta.store,{keyPath:Ta.keyPath,autoIncrement:!0}).createIndex(Ta.userMutationsIndex,Ta.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ia.store)}(t),Qu(t),function(t){t.createObjectStore(Oa.store)}(t));var s=Fa.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Na.store),t.deleteObjectStore(Da.store),t.deleteObjectStore(Aa.store)}(t),Qu(t)),s=s.next(function(){return function(t){var e=t.store(Aa.store),n=new Aa(0,0,si.min().toTimestamp(),0);return e.put(Aa.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Ta.store).Nt().next(function(n){t.deleteObjectStore(Ta.store),t.createObjectStore(Ta.store,{keyPath:Ta.keyPath,autoIncrement:!0}).createIndex(Ta.userMutationsIndex,Ta.userMutationsKeyPath,{unique:!0});var r=e.store(Ta.store),i=n.map(function(t){return r.put(t)});return Fa.waitFor(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(ja.store,{keyPath:ja.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Re(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Sa.store)}(t),i.be(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ve(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Pe(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Oa.store);e.createIndex(Oa.readTimeIndex,Oa.readTimeIndexPath,{unique:!1}),e.createIndex(Oa.collectionReadTimeIndex,Oa.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Ve(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(xa.store,{keyPath:xa.keyPath})}(t),function(t){t.createObjectStore(Ca.store,{keyPath:Ca.keyPath})}(t)})),s},t.prototype.be=function(t){var e=0;return t.store(Oa.store).$t(function(t,n){e+=wu(n)}).next(function(){var n=new Sa(e);return t.store(Sa.store).put(Sa.key,n)})},t.prototype.Re=function(t){var e=this,n=t.store(wa.store),r=t.store(Ta.store);return n.Nt().next(function(n){return Fa.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Ta.userMutationsIndex,i).next(function(r){return Fa.forEach(r,function(r){Jr(r.userId===n.userId);var i=su(e.R,r);return bu(t,n.userId,i).next(function(){})})})})})},t.prototype.ve=function(t){var e=t.store(Na.store),n=t.store(Oa.store);return t.store(Aa.store).get(Aa.key).next(function(t){var r=[];return n.$t(function(n,i){var o=new li(n),s=function(t){return[0,pa(t)]}(o);r.push(e.get(s).next(function(n){return n?Fa.resolve():function(n){return e.put(new Na(0,pa(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Fa.waitFor(r)})})},t.prototype.Pe=function(t,e){t.createObjectStore(ka.store,{keyPath:ka.keyPath});var n=e.store(ka.store),r=new pu,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:pa(i)})}};return e.store(Oa.store).$t({kt:!0},function(t,e){var n=new li(t);return i(n.popLast())}).next(function(){return e.store(Ia.store).$t({kt:!0},function(t,e){var n=va(t[1]);return i(n.popLast())})})},t.prototype.Ve=function(t){var e=this,n=t.store(Da.store);return n.$t(function(t,r){var i=au(r),o=uu(e.R,i);return n.put(o)})},t}();function Qu(t){t.createObjectStore(Na.store,{keyPath:Na.keyPath}).createIndex(Na.documentTargetsIndex,Na.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Da.store,{keyPath:Da.keyPath}).createIndex(Da.queryTargetsIndexName,Da.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Aa.store)}var Hu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Wu=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Gr(Kr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Lu(this,i),this.Le=n+"main",this.R=new Za(u),this.Be=new Va(this.Le,11,new zu(this.R)),this.qe=new Du(this.referenceDelegate,this.R),this.Ut=new yu,this.Ue=function(t,e){return new Vu(t,e)}(this.R,this.Ut),this.Ke=new hu,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&Wr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Gr(Kr.FAILED_PRECONDITION,Hu);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.qe.getHighestSequenceNumber(e)})}).then(function(e){t.Ne=new Br(e,t.De)}).then(function(){t.xe=!0}).catch(function(e){return t.Be&&t.Be.close(),Promise.reject(e)})},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Object(j.b)(e,void 0,void 0,function(){return Object(j.d)(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt(function(n){return Object(j.b)(e,void 0,void 0,function(){return Object(j.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return Object(j.b)(e,void 0,void 0,function(){return Object(j.d)(this,function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Xu(e).put(new ja(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(e).next(function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(e)}).next(function(n){return t.isPrimary&&!n?t.Xe(e).next(function(){return!1}):!!n&&t.Ze(e).next(function(){return!0})})}).catch(function(e){if(Ka(e))return Hr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Hr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Se.enqueueRetryable(function(){return t.Me(e)}),t.isPrimary=e})},t.prototype.Je=function(t){var e=this;return Yu(t).get(ba.key).next(function(t){return Fa.resolve(e.tn(t))})},t.prototype.en=function(t){return Xu(t).delete(this.clientId)},t.prototype.nn=function(){return Object(j.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(j.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=Ya(t,ja.store);return e.Nt().next(function(t){var n=r.rn(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return Fa.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)this.Qe.removeItem(this.on(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Fa.resolve(!0):Yu(t).get(ba.key).next(function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Gr(Kr.FAILED_PRECONDITION,Hu);return!1}}return!(!e.networkEnabled||!e.inForeground)||Xu(t).Nt().next(function(t){return void 0===e.rn(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Hr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return Object(j.b)(this,void 0,void 0,function(){var t=this;return Object(j.d)(this,function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[ba.store,ja.store],function(e){var n=new Wa(e,Br.o);return t.Xe(n).next(function(){return t.en(n)})})];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}})})},t.prototype.rn=function(t,e){var n=this;return t.filter(function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)})},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return Xu(e).Nt().next(function(e){return t.rn(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Tu.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Hr("IndexedDbPersistence","Starting transaction:",t),this.Be.runTransaction(t,"readonly"===e?"readonly":"readwrite",Ra,function(o){return r=new Wa(o,i.Ne?i.Ne.next():Br.o),"readwrite-primary"===e?i.Je(r).next(function(t){return!!t||i.Ye(r)}).next(function(e){if(!e)throw Wr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new Gr(Kr.FAILED_PRECONDITION,Pa);return n(r)}).next(function(t){return i.Ze(r).next(function(){return t})}):i.dn(r).next(function(){return n(r)})}).then(function(t){return r.raiseOnCommittedEvent(),t})},t.prototype.dn=function(t){var e=this;return Yu(t).get(ba.key).next(function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Gr(Kr.FAILED_PRECONDITION,Hu)})},t.prototype.Ze=function(t){var e=new ba(this.clientId,this.allowTabSynchronization,Date.now());return Yu(t).put(ba.key,e)},t.yt=function(){return Va.yt()},t.prototype.Xe=function(t){var e=this,n=Yu(t);return n.get(ba.key).next(function(t){return e.tn(t)?(Hr("IndexedDbPersistence","Releasing primary lease."),n.delete(ba.key)):Fa.resolve()})},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Wr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.je()})},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Hr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Wr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Wr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Yu(t){return Ya(t,ba.store)}function Xu(t){return Ya(t,ja.store)}function $u(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ju=function(t,e){this.progress=t,this.wn=e},Zu=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.yn(t,e,r)})},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t})},t.prototype.gn=function(t,e){t.forEach(function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)})},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next(function(e){return n.En(t,e).next(function(){return e})})},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Si.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):mo(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Si(e)).next(function(t){var e=bs();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=bs();return this.Ut.getCollectionParents(t,i).next(function(s){return Fa.forEach(s,function(s){var a=function(t,e){return new ho(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next(function(t){t.forEach(function(t,e){o=o.insert(t,e)})})}).next(function(){return o})})},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return o.Rn(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=Ki.newInvalidDocument(c),r=r.insert(c,h)),Yo(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}})}).next(function(){return r.forEach(function(t,n){Oo(e,n)||(r=r.remove(t))}),r})},t.prototype.Rn=function(t,e,n){for(var r=Es(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof ts&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},t}(),tc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Es(),i=Es(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),ec=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(si.min())?this.Dn(t,e):this.Sn.pn(t,r).next(function(o){var s=i.Cn(e,o);return(po(e)||yo(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(Qr()<=C.a.DEBUG&&Hr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),_o(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next(function(t){return s.forEach(function(e){t=t.insert(e.key,e)}),t}))})},t.prototype.Cn=function(t,e){var n=new ps(So(t));return e.forEach(function(e,r){Oo(t,r)&&(n=n.add(r))}),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Qr()<=C.a.DEBUG&&Hr("QueryEngine","Using full collection scan to execute query:",_o(e)),this.Sn.getDocumentsMatchingQuery(t,e,si.min())},t}(),nc=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new ls(ni),this.kn=new Fu(function(t){return Qi(t)},Hi),this.$n=si.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Zu(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.Fn)})},t}();function rc(t,e,n,r){return new nc(t,e,n,r)}function ic(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(j.d)(this,function(s){switch(s.label){case 0:return n=Zr(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n._n.getAllMutationBatches(t).next(function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new Zu(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)}).next(function(e){for(var n=[],r=[],s=Es(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++)s=s.add(l[h].key)}for(var f=0,d=e;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var y=0,g=p.mutations;y<g.length;y++)s=s.add(g[y].key)}return i.pn(t,s).next(function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function oc(t,e){var n=Zr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Fa.resolve();return o.forEach(function(t){s=s.next(function(){return r.getEntry(e,t)}).next(function(e){var o=n.docVersions.get(t);Jr(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))})}),s.next(function(){return t._n.removeMutationBatch(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}function sc(t){var e=Zr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function ac(t,e){var n=Zr(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach(function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next(function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)}));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Jr(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}});var a=vs();if(e.documentUpdates.forEach(function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),s.push(uc(t,o,e.documentUpdates,r,void 0).next(function(t){a=t})),!r.isEqual(si.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next(function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)});s.push(u)}return Fa.waitFor(s).next(function(){return o.apply(t)}).next(function(){return n.Mn.En(t,a)}).next(function(){return a})}).then(function(t){return n.Fn=i,t})}function uc(t,e,n,r,i){var o=Es();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=vs();return n.forEach(function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(si.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Hr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),o})}function cc(t,e){var n=Zr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)})}function hc(t,e){var n=Zr(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.qe.getTargetData(t,e).next(function(i){return i?Fa.resolve(r=i):n.qe.allocateTargetId(t).next(function(i){return r=new Ja(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next(function(){return r})})})}).then(function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t})}function lc(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(j.d)(this,function(a){switch(a.label){case 0:r=Zr(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.referenceDelegate.removeTarget(t,i)})];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Ka(s=a.sent()))throw s;return Hr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}})})}function fc(t,e,n){var r=Zr(t),i=si.min(),o=Es();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Zr(t),i=r.kn.get(n);return void 0!==i?Fa.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,wo(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next(function(t){o=t})}).next(function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:si.min(),n?o:Es())}).next(function(t){return{documents:t,Bn:o}})})}function dc(t,e){var n=Zr(t),r=Zr(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.lt(t,e).next(function(t){return t?t.target:null})})}function pc(t){var e=Zr(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Zr(t),i=vs(),o=nu(n),s=Ku(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:Oa.readTimeIndex,range:a},function(t,e){var n=tu(r.R,e);i=i.insert(n.key,n),o=e.readTime}).next(function(){return{wn:i,readTime:ru(o)}})}(e.On,t,e.$n)}).then(function(t){var n=t.wn;return e.$n=t.readTime,n})}function yc(t){return Object(j.b)(this,void 0,void 0,function(){var e;return Object(j.d)(this,function(n){return[2,(e=Zr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Ku(t),n=si.min();return e.$t({index:Oa.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=ru(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.$n=t})]})})}function gc(t,e,n,r){return Object(j.b)(this,void 0,void 0,function(){var i,o,s,a,u,c,h,l,f,d;return Object(j.d)(this,function(p){switch(p.label){case 0:for(i=Zr(t),o=Es(),s=vs(),a=Ts(),u=0,c=n;u<c.length;u++)l=e.qn((h=c[u]).metadata.name),h.document&&(o=o.add(l)),s=s.insert(l,e.Un(h)),a=a.insert(l,e.Kn(h.metadata.readTime));return f=i.On.newChangeBuffer({trackRemovals:!0}),[4,hc(i,function(t){return wo(fo(li.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return uc(t,f,s,si.min(),a).next(function(e){return f.apply(t),e}).next(function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next(function(){return i.qe.addMatchingKeys(t,o,d.targetId)}).next(function(){return i.Mn.En(t,e)}).next(function(){return e})})})]}})})}function vc(t,e,n){return void 0===n&&(n=Es()),Object(j.b)(this,void 0,void 0,function(){var r,i;return Object(j.d)(this,function(o){switch(o.label){case 0:return[4,hc(t,wo(cu(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Zr(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=qs(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ke.saveNamedQuery(t,e);var s=r.withResumeToken(yi.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next(function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)}).next(function(){return i.qe.addMatchingKeys(t,n,r.targetId)}).next(function(){return i.Ke.saveNamedQuery(t,e)})})]}})})}var mc=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Fa.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:qs(n.createTime)}),Fa.resolve()},t.prototype.getNamedQuery=function(t,e){return Fa.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:cu(t.bundledQuery),readTime:qs(t.readTime)}}(e)),Fa.resolve()},t}(),bc=function(){function t(){this.Wn=new ps(wc.Gn),this.zn=new ps(wc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new wc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.Yn(new wc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.Zn=function(t){var e=this,n=new Si(new li([])),r=new wc(n,t),i=new wc(n,t+1),o=[];return this.zn.forEachInRange([r,i],function(t){e.Yn(t),o.push(t.key)}),o},t.prototype.ts=function(){var t=this;this.Wn.forEach(function(e){return t.Yn(e)})},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Si(new li([])),n=new wc(e,t),r=new wc(e,t+1),i=Es();return this.zn.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new wc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),wc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Si.comparator(t.key,e.key)||ni(t.ns,e.ns)},t.Hn=function(t,e){return ni(t.ns,e.ns)||Si.comparator(t.key,e.key)},t}(),Tc=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new ps(wc.Gn)}return t.prototype.checkEmpty=function(t){return Fa.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++;var o=new Xa(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new wc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Fa.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Fa.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.cs(e+1),r=n<0?0:n;return Fa.resolve(this._n.length>r?this._n[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Fa.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Fa.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new wc(e,0),i=new wc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],function(t){var e=n.os(t.ns);o.push(e)}),Fa.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ps(ni);return e.forEach(function(t){var e=new wc(t,0),i=new wc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],function(t){r=r.add(t.ns)})}),Fa.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Si.isDocumentKey(i)||(i=i.child(""));var o=new wc(new Si(i),0),s=new ps(ni);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)},o),Fa.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.os(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Jr(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Fa.forEach(e.mutations,function(i){var o=new wc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(function(){n.rs=r})},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new wc(e,0),r=this.rs.firstAfterOrEqual(n);return Fa.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return Fa.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Ic=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new ls(Si.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Fa.resolve(n?n.document.clone():Ki.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=vs();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Ki.newInvalidDocument(t))}),Fa.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=vs(),i=new Si(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.value,u=a.document,c=a.readTime;if(!e.path.isPrefixOf(s.key.path))break;c.compareTo(n)<=0||Oo(e,u)&&(r=r.insert(u.key,u.clone()))}return Fa.resolve(r)},t.prototype.fs=function(t,e){return Fa.forEach(this.docs,function(t){return e(t)})},t.prototype.newChangeBuffer=function(t){return new Ec(this)},t.prototype.getSize=function(t){return Fa.resolve(this.size)},t}(),Ec=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Object(j.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)}),Fa.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Uu),_c=function(){function t(t){this.persistence=t,this.ds=new Fu(function(t){return Qi(t)},Hi),this.lastRemoteSnapshotVersion=si.min(),this.highestTargetId=0,this.ws=0,this._s=new bc,this.targetCount=0,this.ys=Su.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach(function(t,n){return e(n)}),Fa.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Fa.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Fa.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Fa.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Fa.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Su(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Fa.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Fa.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Fa.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),Fa.waitFor(o).next(function(){return i})},t.prototype.getTargetCount=function(t){return Fa.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Fa.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Fa.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),Fa.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Fa.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Fa.resolve(n)},t.prototype.containsKey=function(t,e){return Fa.resolve(this._s.containsKey(e))},t}(),Oc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Br(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new _c(this),this.Ut=new du,this.Ue=function(t,e){return new Ic(t,function(t){return n.referenceDelegate.ps(t)})}(this.Ut),this.R=new Za(e),this.Ke=new mc(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Tc(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Hr("MemoryPersistence","Starting transaction:",t);var i=new Sc(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.Is=function(t,e){return Fa.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),Sc=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Object(j.c)(e,t),e}(La),Dc=function(){function t(t){this.persistence=t,this.As=new bc,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw $r()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Fa.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Fa.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Fa.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fa.forEach(this.vs,function(r){var i=Si.fromPath(r);return e.Ps(t,i).next(function(t){t||n.removeEntry(i)})}).next(function(){return e.Rs=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Fa.or([function(){return Fa.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Nc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function Ac(t,e){return"firestore_clients_"+t+"_"+e}function kc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function jc(t,e){return"firestore_targets_"+t+"_"+e}Nc.UNAUTHENTICATED=new Nc(null),Nc.GOOGLE_CREDENTIALS=new Nc("google-credentials-uid"),Nc.FIRST_PARTY=new Nc("first-party-uid");var xc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Gr(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Wr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Cc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Gr(i.error.code,i.error.message)),o?new t(e,i.state,r):(Wr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Rc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Os(),s=0;i&&s<r.activeTargetIds.length;++s)i=Oi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Wr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Pc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Wr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Lc=function(){function t(){this.activeTargetIds=Os()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Mc=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new ls(ni),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Ac(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Lc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(j.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a,u,c,h=this;return Object(j.d)(this,function(l){switch(l.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Ac(this.persistenceKey,r)))&&(o=Rc.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)this.Fs(c[u]);return this.$s=[],this.window.addEventListener("pagehide",function(){return h.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(jc(this.persistenceKey,t));if(n){var r=Cc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(jc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.Hs(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Hr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Hr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Hr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Hr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Wr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return Object(j.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(j.d)(this,function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Br.o;if(null!=t)try{var n=JSON.parse(t);Jr("number"==typeof n),e=n}catch(t){Wr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Br.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new xc(this.currentUser,t,e,n),i=kc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=kc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:t}))},t.prototype.Ys=function(t,e,n){var r=jc(this.persistenceKey,t),i=new Cc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Rc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]);return xc.Vs(new Nc(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Cc.Vs(r,e)},t.prototype.js=function(t){return Pc.Vs(t)},t.prototype.ii=function(t){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Hr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.syncEngine.hi(s,a).then(function(){n.ks=r})},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Os();return t.forEach(function(t,n){e=e.unionWith(n.activeTargetIds)}),e},t}(),Fc=function(){function t(){this.li=new Lc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Lc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Uc=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Vc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Hr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Hr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),qc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Bc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Kc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Object(j.c)(e,t),e.prototype.ki=function(t,e,n,r){return new Promise(function(i,o){var s=new qr;s.listenOnce(Mr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Lr.NO_ERROR:var e=s.getResponseJson();Hr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Lr.TIMEOUT:Hr("Connection",'RPC "'+t+'" timed out'),o(new Gr(Kr.DEADLINE_EXCEEDED,"Request time out"));break;case Lr.HTTP_ERROR:var n=s.getStatus();if(Hr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Kr).indexOf(e)>=0?e:Kr.UNKNOWN}(r.status);o(new Gr(a,r.message))}else o(new Gr(Kr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Gr(Kr.UNAVAILABLE,"Connection failed."));break;default:$r()}}finally{Hr("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new jr,i=_e(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Ur({})),this.Fi(o.initMessageHeaders,e),Object(x.n)()||Object(x.p)()||Object(x.l)()||Object(x.m)()||Object(x.q)()||Object(x.k)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Hr("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,h=new Bc({Ei:function(t){c?Hr("Connection","Not sending because WebChannel is closed:",t):(u||(Hr("Connection","Opening WebChannel transport."),a.open(),u=!0),Hr("Connection","WebChannel sending:",t),a.send(t))},Ti:function(){return a.close()}}),l=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return l(a,Vr.EventType.OPEN,function(){c||Hr("Connection","WebChannel transport opened.")}),l(a,Vr.EventType.CLOSE,function(){c||(c=!0,Hr("Connection","WebChannel transport closed"),h.Vi())}),l(a,Vr.EventType.ERROR,function(t){c||(c=!0,Yr("Connection","WebChannel transport errored:",t),h.Vi(new Gr(Kr.UNAVAILABLE,"The operation could not be completed")))}),l(a,Vr.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];Jr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Hr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=is[t];if(void 0!==e)return hs(e)}(i),s=r.message;void 0===o&&(o=Kr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Vi(new Gr(o,s)),a.close()}else Hr("Connection","WebChannel received:",n),h.Si(n)}}),l(i,Fr.STAT_EVENT,function(t){10===t.stat?Hr("Connection","Detected buffering proxy"):11===t.stat&&Hr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Pi()},0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.Di=(t.ssl?"https":"http")+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Hr("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then(function(t){return Hr("RestConnection","Received: ",t),t},function(e){throw Yr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.7.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){return this.Di+"/v1/"+e+":"+qc[t]},t}());function Gc(){return"undefined"!=typeof window?window:null}function zc(){return"undefined"!=typeof document?document:null}function Qc(t){return new Ms(t,!0)}var Hc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&Hr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Ki=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Wc=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Hc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Kr.RESOURCE_EXHAUSTED?(Wr(e.toString()),Wr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Kr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}})})},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(e){t.Yi===n&&t.lr(e)},function(n){e(function(){var e=new Gr(Kr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)})})},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return Object(j.b)(t,void 0,void 0,function(){return Object(j.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.dr=function(t){return Hr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget(function(){return e.Yi===t?n():(Hr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Yc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Object(j.c)(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:$r()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Jr(void 0===e||"string"==typeof e),yi.fromBase64String(e||"")):(Jr(void 0===e||e instanceof Uint8Array),yi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Kr.UNKNOWN:hs(t.code);return new Gr(e,t.message||"")}(a);n=new ks(r,i,o,s||null)}else if("documentChange"in e){i=zs(t,(r=e.documentChange).document.name),o=qs(r.document.updateTime);var a=new qi({mapValue:{fields:r.document.fields}}),u=(s=Ki.newFoundDocument(i,o,a),r.targetIds||[]);n=new Ns(u,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=zs(t,(r=e.documentDelete).document),o=r.readTime?qs(r.readTime):si.min(),a=Ki.newNoDocument(i,o),n=new Ns([],s=r.removedTargetIds||[],a.key,a);else if("documentRemove"in e)i=zs(t,(r=e.documentRemove).document),n=new Ns([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return $r();var c=e.filter;i=new us(r=c.count||0),n=new As(o=c.targetId,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return si.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?si.min():e.readTime?qs(e.readTime):si.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Ws(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Wi(r)?{documents:ta(t,r)}:{query:ea(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Us(t,e.resumeToken):e.snapshotVersion.compareTo(si.min())>0&&(n.readTime=Fs(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return $r()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Ws(this.R),e.removeTarget=t,this.cr(e)},e}(Wc),Xc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Object(j.c)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Jr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Jr(void 0!==e),t.map(function(t){return function(t,e){var n=qs(t.updateTime?t.updateTime:e);return n.isEqual(si.min())&&(n=qs(e)),new Go(n,t.transformResults||[])}(t,e)})):[]}(t.writeResults,t.commitTime),n=qs(t.commitTime);return this.listener.Tr(n,e)}return Jr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Ws(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Js(e.R,t)})};this.cr(n)},e}(Wc),$c=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(j.c)(e,t),e.prototype.br=function(){if(this.Rr)throw new Gr(Kr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Kr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Gr(Kr.UNKNOWN,t.toString())})},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Kr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Gr(Kr.UNKNOWN,t.toString())})},e.prototype.terminate=function(){this.Rr=!0},e}(function(){}),Jc=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Wr(e),this.Vr=!1):Hr("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Zc=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return Object(j.b)(o,void 0,void 0,function(){return Object(j.d)(this,function(t){switch(t.label){case 0:return uh(this)?(Hr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(j.b)(this,void 0,void 0,function(){var e;return Object(j.d)(this,function(n){switch(n.label){case 0:return(e=Zr(t)).Or.add(4),[4,eh(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,th(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new Jc(n,r)};function th(t){return Object(j.b)(this,void 0,void 0,function(){var e,n;return Object(j.d)(this,function(r){switch(r.label){case 0:if(!uh(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function eh(t){return Object(j.b)(this,void 0,void 0,function(){var e,n;return Object(j.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function nh(t,e){var n=Zr(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),ah(n)?sh(n):Eh(n).er()&&ih(n,e))}function rh(t,e){var n=Zr(t),r=Eh(n);n.$r.delete(e),r.er()&&oh(n,e),0===n.$r.size&&(r.er()?r.ir():uh(n)&&n.Br.set("Unknown"))}function ih(t,e){t.qr.U(e.targetId),Eh(t).mr(e)}function oh(t,e){t.qr.U(e),Eh(t).yr(e)}function sh(t){t.qr=new xs({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Eh(t).start(),t.Br.Sr()}function ah(t){return uh(t)&&!Eh(t).tr()&&t.$r.size>0}function uh(t){return 0===Zr(t).Or.size}function ch(t){t.qr=void 0}function hh(t){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(e){return t.$r.forEach(function(e,n){ih(t,e)}),[2]})})}function lh(t,e){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(n){return ch(t),ah(t)?(t.Br.Nr(e),sh(t)):t.Br.set("Unknown"),[2]})})}function fh(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var r,i,o;return Object(j.d)(this,function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof ks&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(j.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.$r.has(o=i[r])?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Hr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,dh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ns?t.qr.X(e):e instanceof As?t.qr.rt(e):t.qr.et(e),n.isEqual(si.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,sc(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach(function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(yi.EMPTY_BYTE_STRING,n.snapshotVersion)),oh(t,e);var r=new Ja(n.target,e,1,n.sequenceNumber);ih(t,r)}}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Hr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,dh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function dh(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var r=this;return Object(j.d)(this,function(i){switch(i.label){case 0:if(!Ka(e))throw e;return t.Or.add(1),[4,eh(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return sc(t.localStore)}),t.asyncQueue.enqueueRetryable(function(){return Object(j.b)(r,void 0,void 0,function(){return Object(j.d)(this,function(e){switch(e.label){case 0:return Hr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,th(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function ph(t,e){return e().catch(function(n){return dh(t,n,e)})}function yh(t){return Object(j.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(j.d)(this,function(s){switch(s.label){case 0:e=Zr(t),n=_h(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return uh(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,cc(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=_h(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,dh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return gh(e)&&vh(e),[2]}})})}function gh(t){return uh(t)&&!_h(t).tr()&&t.kr.length>0}function vh(t){_h(t).start()}function mh(t){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(e){return _h(t).Ar(),[2]})})}function bh(t){return Object(j.b)(this,void 0,void 0,function(){var e,n,r;return Object(j.d)(this,function(i){for(e=_h(t),n=0,r=t.kr;n<r.length;n++)e.Er(r[n].mutations);return[2]})})}function wh(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var r,i;return Object(j.d)(this,function(o){switch(o.label){case 0:return r=t.kr.shift(),i=$a.from(r,e,n),[4,ph(t,function(){return t.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,yh(t)];case 2:return o.sent(),[2]}})})}function Th(t,e){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(n){switch(n.label){case 0:return e&&_h(t).pr?[4,function(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r;return Object(j.d)(this,function(i){switch(i.label){case 0:return cs(r=e.code)&&r!==Kr.ABORTED?(n=t.kr.shift(),_h(t).sr(),[4,ph(t,function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,yh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return gh(t)&&vh(t),[2]}})})}function Ih(t,e){return Object(j.b)(this,void 0,void 0,function(){var n;return Object(j.d)(this,function(r){switch(r.label){case 0:return n=Zr(t),e?(n.Or.delete(2),[4,th(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,eh(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Eh(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Zr(t);return r.br(),new Yc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:hh.bind(null,t),Ri:lh.bind(null,t),_r:fh.bind(null,t)}),t.Mr.push(function(n){return Object(j.b)(e,void 0,void 0,function(){return Object(j.d)(this,function(e){switch(e.label){case 0:return n?(t.Ur.sr(),ah(t)?sh(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),ch(t),e.label=3;case 3:return[2]}})})})),t.Ur}function _h(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=Zr(t);return r.br(),new Xc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:mh.bind(null,t),Ri:Th.bind(null,t),Ir:bh.bind(null,t),Tr:wh.bind(null,t)}),t.Mr.push(function(n){return Object(j.b)(e,void 0,void 0,function(){return Object(j.d)(this,function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,yh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.kr.length>0&&(Hr("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}})})})),t.Kr}var Oh=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Ma,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Gr(Kr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Sh(t,e){if(Wr("AsyncQueue",e+": "+t),Ka(t))return new Gr(Kr.UNAVAILABLE,e+": "+t);throw t}var Dh=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Si.comparator(e.key,n.key)}:function(t,e){return Si.comparator(t.key,e.key)},this.keyedMap=bs(),this.sortedSet=new ls(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Nh=function(){function t(){this.Qr=new ls(Si.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):$r():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Ah=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Dh.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Io(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),kh=function(){this.Wr=void 0,this.listeners=[]},jh=function(){this.queries=new Fu(function(t){return Eo(t)},Io),this.onlineState="Unknown",this.Gr=new Set};function xh(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(j.d)(this,function(c){switch(c.label){case 0:if(n=Zr(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new kh),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=Sh(a,"Initialization of query '"+_o(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Lh(n),[2]}})})}function Ch(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(j.d)(this,function(a){return n=Zr(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function Rh(t,e){for(var n=Zr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hr(s)&&(r=!0);a.Wr=s}}r&&Lh(n)}function Ph(t,e,n){var r=Zr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Lh(t){t.Gr.forEach(function(t){t.next()})}var Mh=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ah(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&"Offline"!==e||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Ah.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Fh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),Uh=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return zs(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?$s(this.R,t.document,!1):Ki.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},t.prototype.Kn=function(t){return qs(t)},t}();!function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new Uh(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||Es()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(j.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(j.d)(this,function(o){switch(o.label){case 0:return[4,gc(this.localStore,new Uh(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,vc(this.localStore,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Ju(Object.assign({},this.progress),t))]}})})}}();var Vh=function(t){this.key=t},qh=function(t){this.key=t},Bh=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Es(),this.mutatedKeys=Es(),this.lo=So(t),this.fo=new Dh(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Nh,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=po(this.query)&&i.size===this.query.limit?i.last():null,c=yo(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=Oo(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(a=!0)),p&&(l?(s=s.add(l),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),po(this.query)||yo(this.query))for(;s.size>this.query.limit;){var h=po(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $r()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)}),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Ah(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Nh,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Es(),this.fo.forEach(function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))});var n=[];return e.forEach(function(e){t.ho.has(e)||n.push(new qh(e))}),this.ho.forEach(function(t){e.has(t)||n.push(new Vh(t))}),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Es();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Ah.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Kh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Gh=function(t){this.key=t,this.bo=!1},zh=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Fu(function(t){return Eo(t)},Io),this.Vo=new Map,this.So=new Set,this.Do=new ls(Si.comparator),this.Co=new Map,this.No=new bc,this.xo={},this.Fo=new Map,this.ko=Su.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function Qh(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(j.d)(this,function(a){switch(a.label){case 0:return n=Tl(t),(i=n.Po.get(e))?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Ro(),[3,4]):[3,1];case 1:return[4,hc(n.localStore,wo(e))];case 2:return o=a.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),[4,Hh(n,e,o.targetId,"current"===s)];case 3:r=a.sent(),n.isPrimaryClient&&nh(n.remoteStore,o),a.label=4;case 4:return[2,r]}})})}function Hh(t,e,n,r){return Object(j.b)(this,void 0,void 0,function(){var i,o,s,a,u,c;return Object(j.d)(this,function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Object(j.b)(this,void 0,void 0,function(){var i,o,s;return Object(j.d)(this,function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,fc(t.localStore,e.query,!1).then(function(t){return e.view._o(t.documents,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(sl(t,e.targetId,s.To),s.snapshot)]}})})}(t,e,n,r)},[4,fc(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Bh(e,i.Bn),s=o._o(i.documents),a=Ds.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),sl(t,n,u.To),c=new Kh(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}})})}function Wh(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i;return Object(j.d)(this,function(o){switch(o.label){case 0:return n=Zr(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(t){return!Io(t,e)})),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,lc(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),rh(n.remoteStore,r.targetId),il(n,r.targetId)}).catch(ju)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return il(n,r.targetId),[4,lc(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Yh(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(j.d)(this,function(a){switch(a.label){case 0:r=Il(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=Zr(t),i=oi.now(),o=e.reduce(function(t,e){return t.add(e.key)},Es());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Mn.pn(t,o).next(function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=Xo(c,n.get(c.key));null!=h&&s.push(new ts(c.key,h,Bi(h.value.mapValue),zo.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)})}).then(function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}})}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new ls(ni)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,cl(r,i.changes)];case 3:return a.sent(),[4,yh(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Sh(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Xh(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r;return Object(j.d)(this,function(i){switch(i.label){case 0:n=Zr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,ac(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach(function(t,e){var r=n.Co.get(e);r&&(Jr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Jr(r.bo):t.removedDocuments.size>0&&(Jr(r.bo),r.bo=!1))}),[4,cl(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,ju(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function $h(t,e,n){var r=Zr(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach(function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Zr(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)}),r&&Lh(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Jh(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var r,i,o,s,a,u;return Object(j.d)(this,function(c){switch(c.label){case 0:return(r=Zr(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new ls(Si.comparator)).insert(o,Ki.newNoDocument(o,si.min())),a=Es().add(o),u=new Ss(si.min(),new Map,new ps(ni),s,a),[4,Xh(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),ul(r),[3,4];case 2:return[4,lc(r.localStore,e,!1).then(function(){return il(r,e,n)}).catch(ju)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Zh(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i;return Object(j.d)(this,function(o){switch(o.label){case 0:n=Zr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,oc(n.localStore,e)];case 2:return i=o.sent(),rl(n,r,null),nl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,cl(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,ju(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function tl(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var r,i;return Object(j.d)(this,function(o){switch(o.label){case 0:r=Zr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Zr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n._n.lookupMutationBatch(t,e).next(function(e){return Jr(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}(r.localStore,e)];case 2:return i=o.sent(),rl(r,e,n),nl(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,cl(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,ju(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function el(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(j.d)(this,function(a){switch(a.label){case 0:uh((n=Zr(t)).remoteStore)||Hr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Zr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e._n.getHighestUnacknowledgedBatchId(t)})}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=Sh(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function nl(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function rl(t,e,n){var r=Zr(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function il(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach(function(e){t.No.containsKey(e)||ol(t,e)})}function ol(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(rh(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),ul(t))}function sl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Vh?(t.No.addReference(o.key,e),al(t,o)):o instanceof qh?(Hr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||ol(t,o.key)):$r()}}function al(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Hr("SyncEngine","New document in limbo: "+n),t.So.add(r),ul(t))}function ul(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Si(li.fromString(e)),r=t.ko.next();t.Co.set(r,new Gh(n)),t.Do=t.Do.insert(n,r),nh(t.remoteStore,new Ja(wo(fo(n.path)),r,2,Br.o))}}function cl(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(j.d)(this,function(a){switch(a.label){case 0:return r=Zr(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(t,a){s.push(r.Oo(a,e,n).then(function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=tc.Pn(a.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c;return Object(j.d)(this,function(h){switch(h.label){case 0:n=Zr(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Fa.forEach(e,function(e){return Fa.forEach(e.bn,function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)}).next(function(){return Fa.forEach(e.vn,function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Ka(r=h.sent()))throw r;return Hr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(u=n.Fn.get(a),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),n.Fn=n.Fn.insert(a,c));return[2]}})})}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function hl(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r;return Object(j.d)(this,function(i){switch(i.label){case 0:return(n=Zr(t)).currentUser.isEqual(e)?[3,3]:(Hr("SyncEngine","User change. New user:",e.toKey()),[4,ic(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach(function(t){t.forEach(function(t){t.reject(new Gr(Kr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,cl(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function ll(t,e){var n=Zr(t),r=n.Co.get(e);if(r&&r.bo)return Es().add(r.key);var i=Es(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=n.Po.get(a[s]);i=i.unionWith(u.view.wo)}return i}function fl(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i;return Object(j.d)(this,function(o){switch(o.label){case 0:return[4,fc((n=Zr(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&sl(n,e.targetId,i.To),i)]}})})}function dl(t){return Object(j.b)(this,void 0,void 0,function(){var e;return Object(j.d)(this,function(n){return[2,pc((e=Zr(t)).localStore).then(function(t){return cl(e,t)})]})})}function pl(t,e,n,r){return Object(j.b)(this,void 0,void 0,function(){var i,o;return Object(j.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Zr(t),r=Zr(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.jt(t,e).next(function(e){return e?n.Mn.pn(t,e):Fa.resolve(null)})})}((i=Zr(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,yh(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(rl(i,e,r||null),nl(i,e),function(t,e){Zr(Zr(t)._n).Gt(e)}(i.localStore,e)):$r(),s.label=4;case 4:return[4,cl(i,o)];case 5:return s.sent(),[3,7];case 6:Hr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function yl(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(j.d)(this,function(c){switch(c.label){case 0:return Tl(n=Zr(t)),Il(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,gl(n,r.toArray())]);case 1:return i=c.sent(),n.$o=!0,[4,Ih(n.remoteStore,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)nh(n.remoteStore,s[o]);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(a=[],u=Promise.resolve(),n.Vo.forEach(function(t,e){n.sharedClientState.isLocalQueryTarget(e)?a.push(e):u=u.then(function(){return il(n,e),lc(n.localStore,e,!0)}),rh(n.remoteStore,e)}),[4,u]);case 4:return c.sent(),[4,gl(n,a)];case 5:return c.sent(),function(t){var e=Zr(t);e.Co.forEach(function(t,n){rh(e.remoteStore,n)}),e.No.ts(),e.Co=new Map,e.Do=new ls(Si.comparator)}(n),n.$o=!1,[4,Ih(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function gl(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,h,l,f,d,p;return Object(j.d)(this,function(y){switch(y.label){case 0:n=Zr(t),r=[],i=[],o=0,s=e,y.label=1;case 1:return o<s.length?(u=void 0,(c=n.Vo.get(a=s[o]))&&0!==c.length?[4,hc(n.localStore,wo(c[0]))]:[3,7]):[3,13];case 2:u=y.sent(),h=0,l=c,y.label=3;case 3:return h<l.length?(f=n.Po.get(l[h]),[4,fl(n,f)]):[3,6];case 4:(d=y.sent()).snapshot&&i.push(d.snapshot),y.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,dc(n.localStore,a)];case 8:return p=y.sent(),[4,hc(n.localStore,p)];case 9:return u=y.sent(),[4,Hh(n,vl(p),a,!1)];case 10:y.sent(),y.label=11;case 11:r.push(u),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function vl(t){return lo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function ml(t){var e=Zr(t);return Zr(Zr(e.localStore).persistence).fn()}function bl(t,e,n,r){return Object(j.b)(this,void 0,void 0,function(){var i,o,s;return Object(j.d)(this,function(a){switch(a.label){case 0:return(i=Zr(t)).$o?(Hr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,pc(i.localStore)];case 3:return o=a.sent(),s=Ss.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,cl(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,lc(i.localStore,e,!0)];case 6:return a.sent(),il(i,e,r),[3,8];case 7:$r(),a.label=8;case 8:return[2]}})})}function wl(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var r,i,o,s,a,u,c,h,l;return Object(j.d)(this,function(f){switch(f.label){case 0:if(!(r=Tl(t)).$o)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.Vo.has(s=o[i])?(Hr("SyncEngine","Adding an already active target "+s),[3,5]):[4,dc(r.localStore,s)]:[3,6];case 2:return a=f.sent(),[4,hc(r.localStore,a)];case 3:return u=f.sent(),[4,Hh(r,vl(a),u.targetId,!1)];case 4:f.sent(),nh(r.remoteStore,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(j.d)(this,function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,lc(r.localStore,t,!1).then(function(){rh(r.remoteStore,t),il(r,t)}).catch(ju)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,l=n,f.label=7;case 7:return h<l.length?[5,c(l[h])]:[3,10];case 8:f.sent(),f.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function Tl(t){var e=Zr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Xh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ll.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Jh.bind(null,e),e.vo._r=Rh.bind(null,e.eventManager),e.vo.Mo=Ph.bind(null,e.eventManager),e}function Il(t){var e=Zr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Zh.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tl.bind(null,e),e}var El=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(e){switch(e.label){case 0:return this.R=Qc(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}})})},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return rc(this.persistence,new ec,t.initialUser,this.R)},t.prototype.qo=function(t){return new Oc(Dc.bs,this.R)},t.prototype.Bo=function(t){return new Fc},t.prototype.terminate=function(){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},t}(),_l=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(j.c)(e,t),e.prototype.initialize=function(e){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,yc(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,Il(this.Qo.syncEngine)];case 4:return n.sent(),[4,yh(this.Qo.remoteStore)];case 5:return n.sent(),[2]}})})},e.prototype.Ko=function(t){return rc(this.persistence,new ec,t.initialUser,this.R)},e.prototype.Uo=function(t){return new Ru(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue)},e.prototype.qo=function(t){var e=$u(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?mu.withCacheSize(this.cacheSizeBytes):mu.DEFAULT;return new Wu(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Gc(),zc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Fc},e}(El),Ol=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(j.c)(e,t),e.prototype.initialize=function(e){return Object(j.b)(this,void 0,void 0,function(){var n,r=this;return Object(j.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Mc?(this.sharedClientState.syncEngine={ui:pl.bind(null,n),ai:bl.bind(null,n),hi:wl.bind(null,n),fn:ml.bind(null,n),ci:dl.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(t){return Object(j.b)(r,void 0,void 0,function(){return Object(j.d)(this,function(e){switch(e.label){case 0:return[4,yl(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Bo=function(t){var e=Gc();if(!Mc.yt(e))throw new Gr(Kr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=$u(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Mc(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(_l),Sl=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(j.b)(this,void 0,void 0,function(){var n=this;return Object(j.d)(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return $h(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=hl.bind(null,this.syncEngine),[4,Ih(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.createEventManager=function(t){return new jh},t.prototype.createDatastore=function(t){var e=Qc(t.databaseInfo.databaseId),n=new Kc(t.databaseInfo);return function(t,e,n){return new $c(t,e,n)}(t.credentials,n,e)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return $h(s.syncEngine,t,0)},o=Vc.yt()?new Vc:new Uc,new Zc(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new zh(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Object(j.b)(this,void 0,void 0,function(){var e;return Object(j.d)(this,function(n){switch(n.label){case 0:return e=Zr(t),Hr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,eh(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},t}(),Dl=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Nl=(function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new Ma,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Lo=function(){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},t.prototype.Ho=function(){return Object(j.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(j.d)(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Fh(JSON.parse(r),t.length+n)]}})})},t.prototype.Zo=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.Jo=function(){return Object(j.b)(this,void 0,void 0,function(){var t,e;return Object(j.d)(this,function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.Xo=function(t){return Object(j.b)(this,void 0,void 0,function(){var e;return Object(j.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return Object(j.b)(this,void 0,void 0,function(){var t,e;return Object(j.d)(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Object(j.b)(this,void 0,void 0,function(){var e,n=this;return Object(j.d)(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Gr(Kr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(j.d)(this,function(u){switch(u.label){case 0:return n=Zr(t),r=Ws(n.R)+"/documents",i={documents:e.map(function(t){return Gs(n.R,t)})},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Jr(!!e.found);var n=zs(t,e.found.name),r=qs(e.found.updateTime),i=new qi({mapValue:{fields:e.found.fields}});return Ki.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Jr(!!e.missing),Jr(!!e.readTime);var n=zs(t,e.missing),r=qs(e.readTime);return Ki.newNoDocument(n,r)}(t,e):$r()}(n.R,t);s.set(e.key.toString(),e)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Jr(!!e),a.push(e)}),a)]}})})}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new ss(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Object(j.b)(this,void 0,void 0,function(){var t,e=this;return Object(j.d)(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=Si.fromPath(n);e.mutations.push(new as(r,e.precondition(r)))}),[4,function(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i;return Object(j.d)(this,function(o){switch(o.label){case 0:return n=Zr(t),r=Ws(n.R)+"/documents",i={writes:e.map(function(t){return Js(n.R,t)})},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw $r();e=si.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Gr(Kr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?zo.updateTime(e):zo.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(si.min()))throw new Gr(Kr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return zo.updateTime(e)}return zo.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),Al=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Hc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji(function(){return Object(j.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(j.d)(this,function(r){return t=new Nl(this.datastore),(e=this.sc(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.ic(t)})})}).catch(function(t){n.ic(t)}),[2]})})})},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Ei(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!cs(e)}return!1},t}(),kl=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Nc.UNAUTHENTICATED,this.clientId=ei.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,function(t){return Object(j.b)(r,void 0,void 0,function(){return Object(j.d)(this,function(e){switch(e.label){case 0:return Hr("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}})})})}return t.prototype.getConfiguration=function(){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Gr(Kr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Ma;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return Object(j.b)(t,void 0,void 0,function(){var t,n;return Object(j.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Sh(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function jl(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(j.d)(this,function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Hr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener(function(t){return Object(j.b)(i,void 0,void 0,function(){return Object(j.d)(this,function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,ic(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}})})}),e.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=e,[2]}})})}function xl(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r;return Object(j.d)(this,function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Cl(t)];case 1:return n=i.sent(),Hr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener(function(t){return function(t,e){return Object(j.b)(this,void 0,void 0,function(){var n,r;return Object(j.d)(this,function(i){switch(i.label){case 0:return(n=Zr(t)).asyncQueue.verifyOperationInProgress(),Hr("RemoteStore","RemoteStore received new credentials"),r=uh(n),n.Or.add(3),[4,eh(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,th(n)];case 3:return i.sent(),[2]}})})}(e.remoteStore,t)}),t.onlineComponents=e,[2]}})})}function Cl(t){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Hr("FirestoreClient","Using default OfflineComponentProvider"),[4,jl(t,new El)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function Rl(t){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Hr("FirestoreClient","Using default OnlineComponentProvider"),[4,xl(t,new Sl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function Pl(t){return Cl(t).then(function(t){return t.persistence})}function Ll(t){return Cl(t).then(function(t){return t.localStore})}function Ml(t){return Rl(t).then(function(t){return t.remoteStore})}function Fl(t){return Rl(t).then(function(t){return t.syncEngine})}function Ul(t){return Object(j.b)(this,void 0,void 0,function(){var e,n;return Object(j.d)(this,function(r){switch(r.label){case 0:return[4,Rl(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Qh.bind(null,e.syncEngine),n.onUnlisten=Wh.bind(null,e.syncEngine),n)]}})})}function Vl(t,e,n){var r=this;void 0===n&&(n={});var i=new Ma;return t.asyncQueue.enqueueAndForget(function(){return Object(j.b)(r,void 0,void 0,function(){var r;return Object(j.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Dl({next:function(o){e.enqueueAndForget(function(){return Ch(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Gr(Kr.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Gr(Kr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Mh(fo(n.path),o,{includeMetadataChanges:!0,so:!0});return xh(t,s)},[4,Ul(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}function ql(t,e,n){var r=this;void 0===n&&(n={});var i=new Ma;return t.asyncQueue.enqueueAndForget(function(){return Object(j.b)(r,void 0,void 0,function(){var r;return Object(j.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Dl({next:function(n){e.enqueueAndForget(function(){return Ch(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Gr(Kr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Mh(n,o,{includeMetadataChanges:!0,so:!0});return xh(t,s)},[4,Ul(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}var Bl=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Kl=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Gl=new Map,zl=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Ql=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable(function(){return e(Nc.UNAUTHENTICATED)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Hl=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable(function(){return e(n.token.user)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Wl=function(){function t(t){var e=this;this.currentUser=Nc.UNAUTHENTICATED,this.oc=new Ma,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable(function(){return e.changeListener(e.currentUser)})};var n=function(t){Hr("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit(function(t){return n(t)}),setTimeout(function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Hr("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}},0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.cc!==e?(Hr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Jr("string"==typeof n.accessToken),new zl(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return Object(j.b)(n,void 0,void 0,function(){return Object(j.d)(this,function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}})})})},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Jr(null===t||"string"==typeof t),new Nc(t)},t}(),Yl=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=Nc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Xl=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Yl(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable(function(){return e(Nc.FIRST_PARTY)})},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function $l(t,e,n){if(!n)throw new Gr(Kr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Jl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Zl(t,e,n,r){if(!0===e&&!0===r)throw new Gr(Kr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function tf(t){if(!Si.isDocumentKey(t))throw new Gr(Kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function ef(t){if(Si.isDocumentKey(t))throw new Gr(Kr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function nf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":$r()}function rf(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Gr(Kr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=nf(t);throw new Gr(Kr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function of(t,e){if(e<=0)throw new Gr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var sf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Gr(Kr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Gr(Kr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Zl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),af=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sf({}),this._settingsFrozen=!1,t instanceof Kl?(this._databaseId=t,this._credentials=new Ql):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Gr(Kr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Kl(t.options.projectId)}(t),this._credentials=new Wl(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Gr(Kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Gr(Kr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sf(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Ql;switch(t.type){case"gapi":var e=t.client;return Jr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Xl(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Gr(Kr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=Gl.get(this))&&(Hr("ComponentProvider","Removing Datastore"),Gl.delete(this),t.terminate()),Promise.resolve();var t},t}(),uf=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new hf(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),cf=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),hf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,fo(r))||this)._path=r,i.type="collection",i}return Object(j.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new uf(this.firestore,null,new Si(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(cf);function lf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(x.h)(t),$l("collection","path",e),t instanceof af)return ef(n=li.fromString.apply(li,Object(j.f)([e],r))),new hf(t,null,n);if(!(t instanceof uf||t instanceof hf))throw new Gr(Kr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return ef(n=li.fromString.apply(li,Object(j.f)([t.path],r)).child(li.fromString(e))),new hf(t.firestore,null,n)}function ff(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(x.h)(t),1===arguments.length&&(e=ei.u()),$l("doc","path",e),t instanceof af)return tf(n=li.fromString.apply(li,Object(j.f)([e],r))),new uf(t,null,new Si(n));if(!(t instanceof uf||t instanceof hf))throw new Gr(Kr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return tf(n=t._path.child(li.fromString.apply(li,Object(j.f)([e],r)))),new uf(t.firestore,t instanceof hf?t.converter:null,new Si(n))}function df(t,e){return t=Object(x.h)(t),e=Object(x.h)(e),(t instanceof uf||t instanceof hf)&&(e instanceof uf||e instanceof hf)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function pf(t,e){return t=Object(x.h)(t),e=Object(x.h)(e),t instanceof cf&&e instanceof cf&&t.firestore===e.firestore&&Io(t._query,e._query)&&t.converter===e.converter}var yf=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new Hc(this,"async_queue_retry"),this.Tc=function(){var e=zc();e&&Hr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=zc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=zc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise(function(t){}):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.wc.push(t),e.Rc()})},t.prototype.Rc=function(){return Object(j.b)(this,void 0,void 0,function(){var t,e=this;return Object(j.d)(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Ka(t=n.sent()))throw t;return Hr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return e.Rc()}),n.label=5;case 5:return[2]}})})},t.prototype.Ac=function(t){var e=this,n=this.dc.then(function(){return e.gc=!0,t().catch(function(t){throw e.yc=t,e.gc=!1,Wr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.gc=!1,t})});return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=Oh.createAndSchedule(this,t,e,n,function(t){return r.bc(t)});return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&$r()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return Object(j.b)(this,void 0,void 0,function(){var t;return Object(j.d)(this,function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then(function(){e.mc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()})},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function gf(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this._progressObserver={},this._taskCompletionResolver=new Ma,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}();var vf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new yf,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Object(j.c)(e,t),e.prototype._terminate=function(){return this._firestoreClient||bf(this),this._firestoreClient.terminate()},e}(af);function mf(t){return t._firestoreClient||bf(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function bf(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Bl(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new kl(t._credentials,t._queue,r)}function wf(t,e,n){var r=this,i=new Ma;return t.asyncQueue.enqueue(function(){return Object(j.b)(r,void 0,void 0,function(){var r;return Object(j.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,jl(t,n)];case 1:return o.sent(),[4,xl(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Kr.FAILED_PRECONDITION||t.code===Kr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Tf(t){if(t._initialized||t._terminated)throw new Gr(Kr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var If=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new di(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),Ef=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(yi.fromBase64String(e))}catch(e){throw new Gr(Kr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(yi.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),_f=function(t){this._methodName=t},Of=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Gr(Kr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Gr(Kr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return ni(this._lat,t._lat)||ni(this._long,t._long)},t}(),Sf=/^__.*__$/,Df=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new ts(t,this.data,this.fieldMask,e,this.fieldTransforms):new Zo(t,this.data,e,this.fieldTransforms)},t}(),Nf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new ts(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function Af(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $r()}}var kf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return Xf(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(Af(this.Cc)&&Sf.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),jf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Qc(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new kf({Cc:t,methodName:e,Bc:n,path:di.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function xf(t){var e=t._freezeSettings(),n=Qc(t._databaseId);return new jf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Cf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qc(o.merge||o.mergeFields?2:0,e,n,i);Qf("Data must be an object, but it was:",s,r);var a,u,c=Gf(r,s);if(o.merge)a=new pi(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var d=Hf(e,f[l],n);if(!s.contains(d))throw new Gr(Kr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");$f(h,d)||h.push(d)}a=new pi(h),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new Df(new qi(c),a,u)}var Rf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.c)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw t.Mc(1===t.Cc?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(_f);function Pf(t,e,n){return new kf({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Lf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.c)(e,t),e.prototype._toFieldTransform=function(t){return new Ko(t.path,new Po)},e.prototype.isEqual=function(t){return t instanceof e},e}(_f),Mf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(j.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Pf(this,t,!0),n=this.Uc.map(function(t){return Kf(t,e)}),r=new Lo(n);return new Ko(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(_f),Ff=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(j.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Pf(this,t,!0),n=this.Uc.map(function(t){return Kf(t,e)}),r=new Fo(n);return new Ko(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(_f),Uf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Object(j.c)(e,t),e.prototype._toFieldTransform=function(t){var e=new Vo(t.R,ko(t.R,this.Kc));return new Ko(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(_f);function Vf(t,e,n,r){var i=t.qc(1,e,n);Qf("Data must be an object, but it was:",i,r);var o=[],s=qi.empty();ui(r,function(t,r){var a=Yf(e,t,n);r=Object(x.h)(r);var u=i.$c(a);if(r instanceof Rf)o.push(a);else{var c=Kf(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new pi(o);return new Nf(s,a,i.fieldTransforms)}function qf(t,e,n,r,i,o){var s=t.qc(1,e,n),a=[Hf(e,r,n)],u=[i];if(o.length%2!=0)throw new Gr(Kr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Hf(e,o[c])),u.push(o[c+1]);for(var h=[],l=qi.empty(),f=a.length-1;f>=0;--f)if(!$f(h,a[f])){var d=a[f],p=u[f];p=Object(x.h)(p);var y=s.$c(d);if(p instanceof Rf)h.push(d);else{var g=Kf(p,y);null!=g&&(h.push(d),l.set(d,g))}}var v=new pi(h);return new Nf(l,v,s.fieldTransforms)}function Bf(t,e,n,r){return void 0===r&&(r=!1),Kf(n,t.qc(r?4:3,e))}function Kf(t,e){if(zf(t=Object(x.h)(t)))return Qf("Unsupported field value:",e,t),Gf(t,e);if(t instanceof _f)return function(t,e){if(!Af(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Kf(o[i],e.Oc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Object(x.h)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ko(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=oi.fromDate(t);return{timestampValue:Fs(e.R,n)}}if(t instanceof oi)return n=new oi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Fs(e.R,n)};if(t instanceof Of)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ef)return{bytesValue:Us(e.R,t._byteString)};if(t instanceof uf){var r=t.firestore._databaseId;if(!r.isEqual(n=e.databaseId))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Bs(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+nf(t))}(t,e)}function Gf(t,e){var n={};return ci(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ui(t,function(t,r){var i=Kf(r,e.xc(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function zf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof oi||t instanceof Of||t instanceof Ef||t instanceof uf||t instanceof _f)}function Qf(t,e,n){if(!zf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=nf(n);throw e.Mc("an object"===r?t+" a custom object":t+" "+r)}}function Hf(t,e,n){if((e=Object(x.h)(e))instanceof If)return e._internalPath;if("string"==typeof e)return Yf(t,e);throw Xf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Wf=new RegExp("[~\\*/\\[\\]]");function Yf(t,e,n){if(e.search(Wf)>=0)throw Xf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(If.bind.apply(If,Object(j.f)([void 0],e.split(".")))))._internalPath}catch(Xd){throw Xf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Xf(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Gr(Kr.INVALID_ARGUMENT,(a+=". ")+t+u)}function $f(t,e){return t.some(function(t){return t.isEqual(e)})}var Jf=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new uf(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Zf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(td("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Zf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Jf);function td(t,e){return"string"==typeof e?Yf(t,e):e instanceof If?e._internalPath:e._delegate._internalPath}var ed=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),nd=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Object(j.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new rd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(td("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Jf),rd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(nd),id=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new ed(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach(function(r){t.call(e,new rd(n._firestore,n._userDataWriter,r.key,r,new ed(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Gr(Kr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map(function(e){return{type:"added",doc:new rd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new ed(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}})}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new rd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new ed(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:od(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function od(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $r()}}function sd(t,e){return t instanceof nd&&e instanceof nd?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof id&&e instanceof id&&t._firestore===e._firestore&&pf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function ad(t){if(yo(t)&&0===t.explicitOrderBy.length)throw new Gr(Kr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ud=function(){};function cd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var hd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qc=e,i.jc=n,i.Wc=r,i.type="where",i}return Object(j.c)(e,t),e.prototype._apply=function(t){var e=xf(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){vd(s,o);for(var u=[],c=0,h=s;c<h.length;c++)u.push(gd(r,t,h[c]));a={arrayValue:{values:u}}}else a=gd(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||vd(s,o),a=Bf(n,"where",s,"in"===o||"not-in"===o);var l=Yi.create(i,o,a);return function(t,e){if(e.g()){var n=vo(t);if(null!==n&&!n.isEqual(e.field))throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=go(t);null!==r&&md(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Gr(Kr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t._query,0,e,t.firestore._databaseId,this.Qc,this.jc,this.Wc);return new cf(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new ho(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(ud),ld=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qc=e,r.Gc=n,r.type="orderBy",r}return Object(j.c)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new so(e,n);return function(t,e){if(null===go(t)){var n=vo(t);null!==n&&md(0,n,e.field)}}(t,r),r}(t._query,this.Qc,this.Gc);return new cf(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new ho(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(ud),fd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return Object(j.c)(e,t),e.prototype._apply=function(t){return new cf(t.firestore,t.converter,To(t._query,this.zc,this.Hc))},e}(ud),dd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(j.c)(e,t),e.prototype._apply=function(t){var e=yd(t,this.type,this.Jc,this.Yc);return new cf(t.firestore,t.converter,function(t,e){return new ho(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(ud),pd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(j.c)(e,t),e.prototype._apply=function(t){var e=yd(t,this.type,this.Jc,this.Yc);return new cf(t.firestore,t.converter,function(t,e){return new ho(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(ud);function yd(t,e,n,r){if(n[0]=Object(x.h)(n[0]),n[0]instanceof Jf)return function(t,e,n,r,i){if(!r)throw new Gr(Kr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=bo(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Ri(e,r.key));else{var c=r.data.field(u.field);if(wi(c))throw new Gr(Kr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new io(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=xf(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Gr(Kr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!mo(t)&&-1!==c.indexOf("/"))throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(li.fromString(c));if(!Si.isDocumentKey(h))throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Si(h);a.push(Ri(e,l))}else{var f=Bf(n,r,c);a.push(f)}}return new io(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function gd(t,e,n){if("string"==typeof(n=Object(x.h)(n))){if(""===n)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!mo(e)&&-1!==n.indexOf("/"))throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(li.fromString(n));if(!Si.isDocumentKey(r))throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ri(t,new Si(r))}if(n instanceof uf)return Ri(t,n._key);throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+nf(n)+".")}function vd(t,e){if(!Array.isArray(t)||0===t.length)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function md(t,e,n){if(!n.isEqual(e))throw new Gr(Kr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var bd=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Di(t)){case 0:return null;case 1:return t.booleanValue;case 2:return mi(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(bi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw $r()}},t.prototype.convertObject=function(t,e){var n=this,r={};return ui(t.fields,function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertGeoPoint=function(t){return new Of(mi(t.latitude),mi(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Ti(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Ii(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=vi(t);return new oi(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=li.fromString(t);Jr(da(n));var r=new Kl(n.get(1),n.get(3)),i=new Si(n.popFirst(5));return r.isEqual(e)||Wr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function wd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Td=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(j.c)(e,t),e.prototype.convertBytes=function(t){return new Ef(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new uf(this.firestore,null,e)},e}(bd),Id=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=xf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Ed(t,this._firestore),i=wd(r.converter,e,n),o=Cf(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,zo.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=Ed(t,this._firestore);return o="string"==typeof(e=Object(x.h)(e))||e instanceof If?qf(this._dataReader,"WriteBatch.update",s._key,e,n,r):Vf(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,zo.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Ed(t,this._firestore);return this._mutations=this._mutations.concat(new ss(e._key,zo.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Gr(Kr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Ed(t,e){if((t=Object(x.h)(t)).firestore!==e)throw new Gr(Kr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var _d=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(j.c)(e,t),e.prototype.convertBytes=function(t){return new Ef(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new uf(this.firestore,null,e)},e}(bd);function Od(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=rf(t,uf);var o=rf(t.firestore,vf),s=xf(o);return Dd(o,[("string"==typeof(e=Object(x.h)(e))||e instanceof If?qf(s,"updateDoc",t._key,e,n,r):Vf(s,"updateDoc",t._key,e)).toMutation(t._key,zo.exists(!0))])}function Sd(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Object(x.h)(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||gf(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(gf(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof uf)c=rf(t.firestore,vf),h=fo(t._key.path),u={next:function(e){i[a]&&i[a](Nd(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=rf(t,cf);c=rf(d.firestore,vf),h=d._query;var p=new _d(c);u={next:function(t){i[a]&&i[a](new id(c,p,d,t))},error:i[a+1],complete:i[a+2]},ad(t._query)}return function(t,e,n,r){var i=this,o=new Dl(r),s=new Mh(e,o,n);return t.asyncQueue.enqueueAndForget(function(){return Object(j.b)(i,void 0,void 0,function(){var e;return Object(j.d)(this,function(n){switch(n.label){case 0:return e=xh,[4,Ul(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(j.b)(i,void 0,void 0,function(){var e;return Object(j.d)(this,function(n){switch(n.label){case 0:return e=Ch,[4,Ul(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(mf(c),h,l,u)}function Dd(t,e){return function(t,e){var n=this,r=new Ma;return t.asyncQueue.enqueueAndForget(function(){return Object(j.b)(n,void 0,void 0,function(){var n;return Object(j.d)(this,function(i){switch(i.label){case 0:return n=Yh,[4,Fl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(mf(t),e)}function Nd(t,e,n){var r=n.docs.get(e._key),i=new _d(t);return new nd(t,i,e._key,r,new ed(n.hasPendingWrites,n.fromCache),e.converter)}var Ad=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Object(j.c)(e,t),e.prototype.get=function(e){var n=this,r=Ed(e,this._firestore),i=new _d(this._firestore);return t.prototype.get.call(this,e).then(function(t){return new nd(n._firestore,i,r._key,t._document,new ed(!1,!1),r.converter)})},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=xf(t)}return t.prototype.get=function(t){var e=this,n=Ed(t,this._firestore),r=new Td(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return $r();var i=t[0];if(i.isFoundDocument())return new Jf(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Jf(e._firestore,r,n._key,null,n.converter);throw $r()})},t.prototype.set=function(t,e,n){var r=Ed(t,this._firestore),i=wd(r.converter,e,n),o=Cf(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Ed(t,this._firestore);return o="string"==typeof(e=Object(x.h)(e))||e instanceof If?qf(this._dataReader,"Transaction.update",s._key,e,n,r):Vf(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=Ed(t,this._firestore);return this._transaction.delete(e._key),this},t}());function kd(){if("undefined"==typeof Uint8Array)throw new Gr(Kr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function jd(){if("undefined"==typeof atob)throw new Gr(Kr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var xd=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return jd(),new t(Ef.fromBase64String(e))},t.fromUint8Array=function(e){return kd(),new t(Ef.fromUint8Array(e))},t.prototype.toBase64=function(){return jd(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return kd(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Cd=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Tf(t=rf(t,vf));var n=mf(t),r=t._freezeSettings(),i=new Sl;return wf(n,i,new _l(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Tf(t=rf(t,vf));var e=mf(t),n=t._freezeSettings(),r=new Sl;return wf(e,r,new Ol(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Gr(Kr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Ma;return t._queue.enqueueAndForgetEvenWhileRestricted(function(){return Object(j.b)(e,void 0,void 0,function(){var e;return Object(j.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(j.b)(this,void 0,void 0,function(){return Object(j.d)(this,function(e){switch(e.label){case 0:return Va.yt()?[4,Va.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}($u(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._delegate)},t}(),Rd=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Kl||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Yr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=rf(t,af))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Yr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=Object(x.d)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Gr(Kr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Hl(new zl(o,new Nc(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(j.b)(e,void 0,void 0,function(){var e,n;return Object(j.d)(this,function(r){switch(r.label){case 0:return[4,Pl(t)];case 1:return e=r.sent(),[4,Ml(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Zr(t);return e.Or.delete(0),th(e)}(n))]}})})})}(mf(rf(this._delegate,vf)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(j.b)(e,void 0,void 0,function(){var e,n;return Object(j.d)(this,function(r){switch(r.label){case 0:return[4,Pl(t)];case 1:return e=r.sent(),[4,Ml(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Object(j.b)(this,void 0,void 0,function(){var e;return Object(j.d)(this,function(n){switch(n.label){case 0:return(e=Zr(t)).Or.add(0),[4,eh(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(mf(rf(this._delegate,vf)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Zl("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Ma;return t.asyncQueue.enqueueAndForget(function(){return Object(j.b)(e,void 0,void 0,function(){var e;return Object(j.d)(this,function(r){switch(r.label){case 0:return e=el,[4,Fl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(mf(rf(this._delegate,vf)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Dl(e);return t.asyncQueue.enqueueAndForget(function(){return Object(j.b)(n,void 0,void 0,function(){var e;return Object(j.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Zr(t).Gr.add(e),e.next()},[4,Ul(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(j.b)(n,void 0,void 0,function(){var e;return Object(j.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Zr(t).Gr.delete(e)},[4,Ul(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(mf(t=rf(t,vf)),gf(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new Gr(Kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Wd(this,lf(this._delegate,t))}catch(t){throw Vd(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Ud(this,ff(this._delegate,t))}catch(t){throw Vd(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new zd(this,function(t,e){if(t=rf(t,af),$l("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new cf(t,null,function(t){return new ho(li.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Vd(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Ma;return t.asyncQueue.enqueueAndForget(function(){return Object(j.b)(n,void 0,void 0,function(){var n;return Object(j.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Rl(t).then(function(t){return t.datastore})}(t)];case 1:return n=i.sent(),new Al(t.asyncQueue,n,e,r).run(),[2]}})})}),r.promise}(mf(t),function(n){return e(new Ad(t,n))})}(this._delegate,function(n){return t(new Ld(e,n))})},t.prototype.batch=function(){var t=this;return mf(this._delegate),new Md(new Id(this._delegate,function(e){return Dd(t._delegate,e)}))},t.prototype.loadBundle=function(t){throw new Gr(Kr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Gr(Kr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Pd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(j.c)(e,t),e.prototype.convertBytes=function(t){return new xd(new Ef(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Ud.tu(e,this.firestore,null)},e}(bd),Ld=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Pd(t)}return t.prototype.get=function(t){var e=this,n=Yd(t);return this._delegate.get(n).then(function(t){return new Kd(e._firestore,new nd(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},t.prototype.set=function(t,e,n){var r=Yd(t);return n?(Jl("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Yd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(j.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Yd(t);return this._delegate.delete(e),this},t}(),Md=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Yd(t);return n?(Jl("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Yd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(j.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Yd(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Fd=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new rd(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Gd(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Pd(e),n),i.set(n,o)),o},t}();Fd.nu=new WeakMap;var Ud=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Pd(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new Gr(Kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new uf(n._delegate,r,new Si(e)))},t.tu=function(e,n,r){return new t(n,new uf(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Wd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Wd(this.firestore,lf(this._delegate,t))}catch(t){throw Vd(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Object(x.h)(t))instanceof uf&&df(this._delegate,t)},t.prototype.set=function(t,e){e=Jl("DocumentReference.set",e);try{return function(t,e,n){t=rf(t,uf);var r=rf(t.firestore,vf),i=wd(t.converter,e,n);return Dd(r,[Cf(xf(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,zo.none())])}(this._delegate,t,e)}catch(t){throw Vd(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Od(this._delegate,t):Od.apply(void 0,Object(j.f)([this._delegate,t,e],n))}catch(t){throw Vd(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Dd(rf((t=this._delegate).firestore,vf),[new ss(t._key,zo.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=qd(e),i=Bd(e,function(e){return new Kd(t.firestore,new nd(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))});return Sd(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=rf(t,uf);var e=rf(t.firestore,vf),n=mf(e),r=new _d(e);return function(t,e){var n=this,r=new Ma;return t.asyncQueue.enqueueAndForget(function(){return Object(j.b)(n,void 0,void 0,function(){var n;return Object(j.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var r,i;return Object(j.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Zr(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Mn.mn(t,e)})}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Gr(Kr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Sh(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Ll(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._key).then(function(n){return new nd(e,r,t._key,n,new ed(null!==n&&n.hasLocalMutations,!0),t.converter)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=rf(t,uf);var e=rf(t.firestore,vf);return Vl(mf(e),t._key,{source:"server"}).then(function(n){return Nd(e,t,n)})}(this._delegate):function(t){t=rf(t,uf);var e=rf(t.firestore,vf);return Vl(mf(e),t._key).then(function(n){return Nd(e,t,n)})}(this._delegate)).then(function(t){return new Kd(e.firestore,new nd(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Fd.eu(this.firestore,e):null))},t}();function Vd(t,e,n){return t.message=t.message.replace(e,n),t}function qd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!gf(r))return r}return{}}function Bd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=gf(t[0])?t[0]:gf(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Kd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Ud(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return sd(this._delegate,t._delegate)},t}(),Gd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(j.c)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Kd),zd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Pd(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,cd(this._delegate,function(t,e,n){var r=e,i=td("where",t);return new hd(i,r,n)}(e,n,r)))}catch(e){throw Vd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,cd(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=td("orderBy",t);return new ld(r,n)}(e,n)))}catch(e){throw Vd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,cd(this._delegate,function(t){return of("limit",t),new fd("limit",t,"F")}(e)))}catch(e){throw Vd(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,cd(this._delegate,function(t){return of("limitToLast",t),new fd("limitToLast",t,"L")}(e)))}catch(e){throw Vd(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,cd(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new dd("startAt",t,!0)}).apply(void 0,e)))}catch(e){throw Vd(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,cd(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new dd("startAfter",t,!1)}).apply(void 0,e)))}catch(e){throw Vd(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,cd(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new pd("endBefore",t,!0)}).apply(void 0,e)))}catch(e){throw Vd(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,cd(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new pd("endAt",t,!1)}).apply(void 0,e)))}catch(e){throw Vd(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return pf(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=rf(t,cf);var e=rf(t.firestore,vf),n=mf(e),r=new _d(e);return function(t,e){var n=this,r=new Ma;return t.asyncQueue.enqueueAndForget(function(){return Object(j.b)(n,void 0,void 0,function(){var n;return Object(j.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(j.b)(this,void 0,void 0,function(){var r,i,o,s,a;return Object(j.d)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,fc(t,e,!0)];case 1:return a=u.sent(),r=new Bh(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Sh(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})},[4,Ll(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._query).then(function(n){return new id(e,r,t,n)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=rf(t,cf);var e=rf(t.firestore,vf),n=mf(e),r=new _d(e);return ql(n,t._query,{source:"server"}).then(function(n){return new id(e,r,t,n)})}(this._delegate):function(t){t=rf(t,cf);var e=rf(t.firestore,vf),n=mf(e),r=new _d(e);return ad(t._query),ql(n,t._query).then(function(n){return new id(e,r,t,n)})}(this._delegate)).then(function(t){return new Hd(e.firestore,new id(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=qd(e),i=Bd(e,function(e){return new Hd(t.firestore,new id(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return Sd(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Fd.eu(this.firestore,e):null))},t}(),Qd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Gd(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Hd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new zd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new Gd(t._firestore,e)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new Qd(e._firestore,t)})},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach(function(r){t.call(e,new Gd(n._firestore,r))})},t.prototype.isEqual=function(t){return sd(this._delegate,t._delegate)},t}(),Wd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Object(j.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Ud(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Ud(this.firestore,void 0===t?ff(this._delegate):ff(this._delegate,t))}catch(t){throw Vd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=rf(t.firestore,vf),r=ff(t),i=wd(t.converter,e);return Dd(n,[Cf(xf(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,zo.exists(!1))]).then(function(){return r})}(this._delegate,t).then(function(t){return new Ud(e.firestore,t)})},e.prototype.isEqual=function(t){return df(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?Fd.eu(this.firestore,t):null))},e}(zd);function Yd(t){return rf(t,uf)}var Xd,$d=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(If.bind.apply(If,Object(j.f)([void 0],t)))}return t.documentId=function(){return new t(di.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Object(x.h)(t))instanceof If&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Jd=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Lf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Rf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Mf("arrayUnion",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ff("arrayRemove",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Uf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),Zd=n("/6Yf"),tp={Firestore:Rd,GeoPoint:Of,Timestamp:oi,Blob:xd,Transaction:Ld,WriteBatch:Md,DocumentReference:Ud,DocumentSnapshot:Kd,Query:zd,QueryDocumentSnapshot:Gd,QuerySnapshot:Hd,CollectionReference:Wd,FieldPath:$d,FieldValue:Jd,setLogLevel:function(t){zr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Zd.a("firestore",function(t){return function(t,e){return new Rd(t,new vf(t,e),new Cd)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},tp)))})(Xd=k.a),Xd.registerVersion("@firebase/firestore","2.3.8");var ep=n("UbJi");function np(t,e){return function(t,e=v.b){return new m.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function rp(t,e){return np(t,e).pipe(Object(E.a)(t=>({payload:t,type:"query"})))}function ip(t,e){return rp(t,e).pipe(Object(T.a)(void 0),Object(I.a)(),Object(E.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function op(t,e,n){return ip(t,n).pipe(Object(_.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return sp(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return sp(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return sp(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(O.a)(),Object(E.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function sp(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function ap(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class up{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=ip(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(E.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(T.a)(void 0),Object(I.a)(),Object(S.a)(([t,e])=>e.length>0||!t),Object(E.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(_.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=ap(t);return op(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return rp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(E.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(b.a)(this.query.get(t)).pipe(Object(D.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new cp(this.ref.doc(t),this.afs)}}class cp{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=yp(n,e);return new up(r,i,this.afs)}snapshotChanges(){return np(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(T.a)(void 0),Object(I.a)(),Object(E.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(E.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(b.a)(this.ref.get(t)).pipe(Object(D.b)(this.afs.schedulers.insideAngular))}}class hp{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?ip(this.query,this.afs.schedulers.outsideAngular).pipe(Object(E.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(S.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):ip(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(_.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=ap(t);return op(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return rp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(E.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(b.a)(this.query.get(t)).pipe(Object(D.b)(this.afs.schedulers.insideAngular))}}const lp=new i.s("angularfire2.enableFirestorePersistence"),fp=new i.s("angularfire2.firestore.persistenceSettings"),dp=new i.s("angularfire2.firestore.settings"),pp=new i.s("angularfire2.firestore.use-emulator");function yp(t,e=(t=>t)){return{query:e(t),ref:t}}let gp=(()=>{class t{constructor(t,e,n,i,o,s,a,u,c){this.schedulers=new N.d(s),this.keepUnstableUntilFirst=Object(N.h)(this.schedulers);const h=Object(N.g)(t,s,e);!A.a.auth&&c&&Object(N.j)();const l=u;[this.firestore,this.persistenceEnabled$]=Object(N.f)(`${h.name}.firestore`,"AngularFirestore",h,()=>{const t=s.runOutsideAngular(()=>h.firestore());if(i&&t.settings(i),l&&t.useEmulator(...l),n&&!Object(r.u)(o)){const e=()=>{try{return Object(b.a)(t.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(Xd){return"undefined"!=typeof console&&console.warn(Xd),Object(w.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(w.a)(!1)]},[i,l,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=yp(n,e),o=this.schedulers.ngZone.run(()=>r);return new up(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new hp(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new cp(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(i.Yb(N.c),i.Yb(N.b,8),i.Yb(lp,8),i.Yb(dp,8),i.Yb(i.D),i.Yb(i.B),i.Yb(fp,8),i.Yb(pp,8),i.Yb(ep.b,8))},t.\u0275prov=i.Kb({factory:function(){return new t(i.Yb(N.c),i.Yb(N.b,8),i.Yb(lp,8),i.Yb(dp,8),i.Yb(i.D),i.Yb(i.B),i.Yb(fp,8),i.Yb(pp,8),i.Yb(ep.b,8))},token:t,providedIn:"any"}),t})();var vp=n("kmnG"),mp=n("qFsG"),bp=n("3Pt+");let wp=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("books").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak Dapat Menyimpan Data")})}else this.db.collection("books/").doc(this.data.id).update(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak Dapat Mengupdate Data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(g.g),i.Ob(g.a),i.Ob(gp),i.Ob(ep.a))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-product-detail"]],decls:24,vars:6,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"disabled","click"]],template:function(t,e){1&t&&(i.Ub(0,"h3",0),i.yc(1," Detail Produk "),i.Tb(),i.Ub(2,"div",1),i.Ub(3,"mat-form-field",2),i.Ub(4,"mat-label"),i.yc(5,"No"),i.Tb(),i.Ub(6,"input",3),i.bc("ngModelChange",function(t){return e.data.no=t}),i.Tb(),i.Tb(),i.Ub(7,"mat-form-field",2),i.Ub(8,"mat-label"),i.yc(9,"Nama Makanan"),i.Tb(),i.Ub(10,"input",3),i.bc("ngModelChange",function(t){return e.data.foodname=t}),i.Tb(),i.Tb(),i.Ub(11,"mat-form-field",2),i.Ub(12,"mat-label"),i.yc(13,"Resep"),i.Tb(),i.Ub(14,"input",3),i.bc("ngModelChange",function(t){return e.data.recipes=t}),i.Tb(),i.Tb(),i.Ub(15,"mat-form-field",2),i.Ub(16,"mat-label"),i.yc(17,"Kalori"),i.Tb(),i.Ub(18,"input",3),i.bc("ngModelChange",function(t){return e.data.calories=t}),i.Tb(),i.Tb(),i.Tb(),i.Ub(19,"div",4),i.Ub(20,"button",5),i.yc(21,"Batal"),i.Tb(),i.Ub(22,"button",6),i.bc("click",function(){return e.saveData()}),i.yc(23),i.Tb(),i.Tb()),2&t&&(i.Db(6),i.kc("ngModel",e.data.no),i.Db(4),i.kc("ngModel",e.data.foodname),i.Db(4),i.kc("ngModel",e.data.recipes),i.Db(4),i.kc("ngModel",e.data.calories),i.Db(4),i.kc("disabled",e.loading),i.Db(1),i.zc(e.loading?"Menyimpan..":"Simpan"))},directives:[g.h,g.e,vp.b,vp.e,mp.b,bp.c,bp.j,bp.l,g.c,a.a,g.d],styles:[""]}),t})();var Tp=n("Xa2L"),Ip=n("Wp6s");function Ep(t,e){1&t&&(i.Ub(0,"div",2),i.Pb(1,"mat-spinner"),i.Tb())}function _p(t,e){if(1&t){const t=i.Vb();i.Ub(0,"tr"),i.Pb(1,"th"),i.Ub(2,"td"),i.yc(3),i.Tb(),i.Ub(4,"td"),i.yc(5),i.Tb(),i.Ub(6,"td"),i.yc(7),i.Tb(),i.Ub(8,"td"),i.yc(9),i.Tb(),i.Ub(10,"td",7),i.Ub(11,"button",9),i.bc("click",function(){i.rc(t);const n=e.$implicit,r=e.index;return i.fc(2).productDetail(n,r)}),i.yc(12,"Edit"),i.Tb(),i.Ub(13,"button",10),i.bc("click",function(){i.rc(t);const n=e.$implicit,r=e.index;return i.fc(2).deleteProduct(n.id,r)}),i.yc(14),i.Tb(),i.Tb(),i.Tb()}if(2&t){const t=e.$implicit,n=e.index,r=i.fc(2);i.Db(3),i.zc(n+1),i.Db(2),i.zc(t.foodname),i.Db(2),i.zc(t.recipes),i.Db(2),i.zc(t.calories),i.Db(4),i.kc("disabled",r.loadingDelete[n]),i.Db(1),i.zc("Delete")}}function Op(t,e){if(1&t){const t=i.Vb();i.Ub(0,"mat-card"),i.Ub(1,"mat-card-header"),i.Ub(2,"mat-card-title"),i.yc(3),i.Tb(),i.Tb(),i.Ub(4,"mat-card-content"),i.Ub(5,"div",3),i.Pb(6,"span",4),i.Ub(7,"button",5),i.bc("click",function(){return i.rc(t),i.fc().productDetail({},-1)}),i.yc(8,"Tambah Produk"),i.Tb(),i.Tb(),i.Ub(9,"table",6),i.Ub(10,"thead"),i.Pb(11,"th"),i.Ub(12,"th"),i.yc(13,"No"),i.Tb(),i.Ub(14,"th"),i.yc(15,"Nama Makanan"),i.Tb(),i.Ub(16,"th"),i.yc(17,"Resep"),i.Tb(),i.Ub(18,"th"),i.yc(19,"Kalori"),i.Tb(),i.Pb(20,"th",7),i.Tb(),i.Ub(21,"tbody"),i.xc(22,_p,15,6,"tr",8),i.Tb(),i.Tb(),i.Tb(),i.Tb()}if(2&t){const t=i.fc();i.Db(3),i.zc(t.title),i.Db(19),i.kc("ngForOf",t.books)}}const Sp=[{path:"",component:f,children:[{path:"dashboard",component:d},{path:"product",component:(()=>{class t{constructor(t,e,n){this.dialog=t,this.auth=e,this.db=n,this.books={},this.userData={},this.loadingDelete={}}ngOnInit(){this.title="Product",this.auth.user.subscribe(t=>{this.userData=t,this.getBooks()})}getBooks(){this.loading=!0,this.db.collection("books",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.books=t,this.loading=!1},t=>{this.loading=!1})}productDetail(t,e){this.dialog.open(wp,{width:"400px",data:t}).afterClosed().subscribe(t=>{})}deleteProduct(t,e){confirm("Delete item?")&&this.db.collection("books").doc(t).delete().then(t=>{this.books.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak dapat menghapus data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(g.b),i.Ob(ep.a),i.Ob(gp))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-product"]],decls:2,vars:2,consts:[["class","height: 300px;","class","uk-flex uk-flex-center uk-flex-middle",4,"ngIf"],[4,"ngIf"],[1,"uk-flex","uk-flex-center","uk-flex-middle"],[1,"uk-flex"],[1,"uk-width-expand"],["mat-flat-button","","color","primary",3,"click"],[1,"uk-table","uk-table-middle","uk-table-divider"],["align","right"],[4,"ngFor","ngForOf"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"disabled","click"]],template:function(t,e){1&t&&(i.xc(0,Ep,2,0,"div",0),i.xc(1,Op,23,2,"mat-card",1)),2&t&&(i.kc("ngIf",e.loading),i.Db(1),i.kc("ngIf",!e.loading))},directives:[r.k,Tp.b,Ip.a,Ip.c,Ip.e,Ip.b,a.a,r.j],styles:[""]}),t})()},{path:"images",component:y},{path:"",pathMatch:"full",redirectTo:"/admin/dashboard"}]}];let Dp=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Mb({type:t}),t.\u0275inj=i.Lb({imports:[[r.c,o.c.forChild(Sp),p.a,bp.f]]}),t})()}}]);